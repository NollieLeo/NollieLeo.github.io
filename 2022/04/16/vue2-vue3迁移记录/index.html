<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>vue2~vue3è¿ç§»è®°å½• - ç¿å…ˆæ£®çš„åšå®¢</title>

  
    <meta name="description" content="è®°å½•vue2åˆ°vue3ç‰ˆæœ¬è¿ç§»äº‹é¡¹ å®˜æ–¹è¿ç§»æ–‡æ¡£  apiå˜åŒ–å…¨å±€apiå˜åŒ–new Vue â€”&gt; createApp ğŸš© â• vue2ä¸­æ²¡æœ‰app çš„æ¦‚å¿µï¼Œé€šè¿‡Vueçš„ç»Ÿä¸€æ„é€ å‡½æ•°è¿›è¡Œå…¨å±€çš„é…ç½®ï¼Œå•é¡µåº”ç”¨ä¸­æ— æ³•åˆ›å»ºå¤šä¸ªä¸åŒå…¨å±€é…ç½®çš„æ ¹åº”ç”¨ï¼ˆä¼šé€ æˆå…¨å±€é…ç½®æ±¡æŸ“ï¼‰ vue3ä¸­æœ‰äº†appæ¦‚å¿µï¼Œé€šè¿‡createAppåˆ›å»ºè¿”å›çš„å®ä¾‹æš´éœ²å…¨å±€apiï¼Œè§£å†³äº†vue2ä¸­çš„é—®é¢˜   Vue2 123456">
<meta property="og:type" content="article">
<meta property="og:title" content="vue2~vue3è¿ç§»è®°å½•">
<meta property="og:url" content="https://github.com/NollieLeo/2022/04/16/vue2-vue3%E8%BF%81%E7%A7%BB%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="ç¿å…ˆæ£®çš„åšå®¢">
<meta property="og:description" content="è®°å½•vue2åˆ°vue3ç‰ˆæœ¬è¿ç§»äº‹é¡¹ å®˜æ–¹è¿ç§»æ–‡æ¡£  apiå˜åŒ–å…¨å±€apiå˜åŒ–new Vue â€”&gt; createApp ğŸš© â• vue2ä¸­æ²¡æœ‰app çš„æ¦‚å¿µï¼Œé€šè¿‡Vueçš„ç»Ÿä¸€æ„é€ å‡½æ•°è¿›è¡Œå…¨å±€çš„é…ç½®ï¼Œå•é¡µåº”ç”¨ä¸­æ— æ³•åˆ›å»ºå¤šä¸ªä¸åŒå…¨å±€é…ç½®çš„æ ¹åº”ç”¨ï¼ˆä¼šé€ æˆå…¨å±€é…ç½®æ±¡æŸ“ï¼‰ vue3ä¸­æœ‰äº†appæ¦‚å¿µï¼Œé€šè¿‡createAppåˆ›å»ºè¿”å›çš„å®ä¾‹æš´éœ²å…¨å±€apiï¼Œè§£å†³äº†vue2ä¸­çš„é—®é¢˜   Vue2 123456">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/Users/leo/Library/Application%20Support/typora-user-images/image-20220416124853316.png">
<meta property="article:published_time" content="2022-04-16T02:59:12.000Z">
<meta property="article:modified_time" content="2023-01-28T13:32:15.406Z">
<meta property="article:author" content="ç¿å…ˆæ£®">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="Vite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Users/leo/Library/Application%20Support/typora-user-images/image-20220416124853316.png">
  
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="ç¿å…ˆæ£®çš„åšå®¢" type="application/atom+xml">
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    <link rel="shortcut icon" href="/assets/avatar.png">
  

  

  


  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    

  

<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/assets/avatar.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">ç¿å…ˆæ£®çš„åšå®¢</div><div class="sub cap">ä¹Œæ‹‰</div></a></div>

<nav class="menu dis-select"><a class="nav-item active" href="/">åšå®¢</a><a class="nav-item" href="/wiki/">é¡¹ç›®</a><a class="nav-item" href="/notes/">ç¬”è®°</a><a class="nav-item" href="/more/">æ›´å¤š</a></nav>
</header>


<div class="widgets">
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/blog/" placeholder="æ–‡ç« æœç´¢"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼</div></div></div></widget>


<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">vue2~vue3è¿ç§»è®°å½•</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#api%E5%8F%98%E5%8C%96"><span class="toc-text">apiå˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80api%E5%8F%98%E5%8C%96"><span class="toc-text">å…¨å±€apiå˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#new-Vue-%E2%80%94-gt-createApp-%F0%9F%9A%A9-%E2%9E%95"><span class="toc-text">new Vue â€”&gt; createApp ğŸš© â•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#internal-Apis-%F0%9F%9A%A9"><span class="toc-text">internal Apis  ğŸš©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-config"><span class="toc-text">app.config</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#globalProperties-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">globalProperties  ğŸš©â•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devtools"><span class="toc-text">devtools</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#errorHandler"><span class="toc-text">errorHandler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#warnHandler"><span class="toc-text">warnHandler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#isCustomElement-%E2%9E%95"><span class="toc-text">isCustomElement â•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#optionMergeStrategies"><span class="toc-text">optionMergeStrategies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%89%E9%A1%B9%E5%90%88%E5%B9%B6%E7%AD%96%E7%95%A5%E3%80%91mixin"><span class="toc-text">ã€è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶ç­–ç•¥ã€‘mixin</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#performance"><span class="toc-text">performance</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-directive"><span class="toc-text">app.directive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-unmount-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">app.unmount ğŸš©â•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-component"><span class="toc-text">app.component</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch"><span class="toc-text">watch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#emits-%E2%9E%95"><span class="toc-text">emits â•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5provide-inject"><span class="toc-text">ä¾èµ–æ³¨å…¥provide&#x2F;inject</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">åŸºç¡€ä½¿ç”¨æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E6%96%B9%E6%B3%95-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">å“åº”å¼æ–¹æ³•  ğŸš©â•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%8A%E7%AB%AF"><span class="toc-text">å¼Šç«¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#defineAsyncComponent-%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-text">defineAsyncComponent(å¼‚æ­¥ç»„ä»¶)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">ç”Ÿå‘½å‘¨æœŸå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8E-2-x-%E7%89%88%E6%9C%AC%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9B%B8%E5%AF%B9%E5%BA%94%E7%9A%84%E7%BB%84%E5%90%88%E5%BC%8F-API-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">ä¸ 2.x ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸç›¸å¯¹åº”çš„ç»„åˆå¼ API ğŸš©â•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E7%BB%84%E5%90%88%E5%BC%8Fapi"><span class="toc-text">éç»„åˆå¼api</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%8C%87%E4%BB%A4%E5%8F%98%E5%8C%96"><span class="toc-text">å†…ç½®æŒ‡ä»¤å˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#v-model-%F0%9F%9A%A9"><span class="toc-text">v-model ğŸš©</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="toc-text">ç»„ä»¶ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-is-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">v-is ğŸš©â•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-slot-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">v-slot ğŸš©â•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E5%8F%98%E5%8C%96-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">è‡ªå®šä¹‰æŒ‡ä»¤å˜åŒ– ğŸš©â•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6"><span class="toc-text">å†…ç½®ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#teleport-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">teleport ğŸš©â•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Suspense-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">Suspense ğŸš©â•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragments-%F0%9F%9A%A9%E2%9E%95"><span class="toc-text">Fragments ğŸš©â•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F-%F0%9F%9A%A9%F0%9F%9A%A9%F0%9F%9A%A9"><span class="toc-text">ç›¸åº”å¼ç³»ç»Ÿ ğŸš©ğŸš©ğŸš©</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F-API"><span class="toc-text">å“åº”å¼ç³»ç»Ÿ API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reactive"><span class="toc-text">reactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref"><span class="toc-text">ref</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%B7%E9%98%B1"><span class="toc-text">é™·é˜±</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%83%E6%99%BA%E8%B4%9F%E6%8B%85%E4%B8%8A-ref-vs-reactive"><span class="toc-text">å¿ƒæ™ºè´Ÿæ‹…ä¸Š ref  vs  reactive</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readonly"><span class="toc-text">readonly</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reactive%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%B7%A5%E5%85%B7%E9%9B%86"><span class="toc-text">reactiveå“åº”å¼ç³»ç»Ÿå·¥å…·é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#isProxy"><span class="toc-text">isProxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isReactive"><span class="toc-text">isReactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isReadonly"><span class="toc-text">isReadonly</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reactive%E9%AB%98%E7%BA%A7%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9FAPI"><span class="toc-text">reactiveé«˜çº§å“åº”å¼ç³»ç»ŸAPI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#toRaw"><span class="toc-text">toRaw</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#markRaw"><span class="toc-text">markRaw</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#markRaw%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-text">markRawæ³¨æ„ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowReactive"><span class="toc-text">shallowReactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowReadonly"><span class="toc-text">shallowReadonly</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ref-%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%B7%A5%E5%85%B7%E9%9B%86"><span class="toc-text">ref å“åº”å¼ç³»ç»Ÿå·¥å…·é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unref"><span class="toc-text">unref</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRef"><span class="toc-text">toRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRefs"><span class="toc-text">toRefs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isRef"><span class="toc-text">isRef</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ref-%E9%AB%98%E7%BA%A7%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9FAPI"><span class="toc-text">ref é«˜çº§å“åº”å¼ç³»ç»ŸAPI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#customRef"><span class="toc-text">customRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowRef"><span class="toc-text">shallowRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#triggerRef-%E3%80%90%E4%B8%8EshallowRef%E9%85%8D%E5%90%88%E3%80%91"><span class="toc-text">triggerRef ã€ä¸shallowRefé…åˆã€‘</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Composition-API"><span class="toc-text">Composition API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#setup"><span class="toc-text">setup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="toc-text">è°ƒç”¨æ—¶æœº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-text">å‚æ•°</span></a></li></ol></li></ol></li></ol></div></div></widget>




</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/NollieLeo" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/logo-github.svg"/></a></div></footer>

    </aside>
    <div class='l_main'>
      

      


<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">ä¸»é¡µ</a><span class="sep"></span><a class="cap breadcrumb" href="/">æ–‡ç« </a></div><div id="post-meta">å‘å¸ƒäº&nbsp;<time datetime="2022-04-16T02:59:12.000Z">2022-04-16</time></div></div>

<article class='md-text content post'>
<h1 class="article-title"><span>vue2~vue3è¿ç§»è®°å½•</span></h1>
<blockquote>
<p>è®°å½•vue2åˆ°vue3ç‰ˆæœ¬è¿ç§»äº‹é¡¹</p>
<p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/introduction.html">å®˜æ–¹è¿ç§»æ–‡æ¡£</a></p>
</blockquote>
<h1 id="apiå˜åŒ–"><a href="#apiå˜åŒ–" class="headerlink" title="apiå˜åŒ–"></a>apiå˜åŒ–</h1><h2 id="å…¨å±€apiå˜åŒ–"><a href="#å…¨å±€apiå˜åŒ–" class="headerlink" title="å…¨å±€apiå˜åŒ–"></a>å…¨å±€apiå˜åŒ–</h2><h3 id="new-Vue-â€”-gt-createApp-ğŸš©-â•"><a href="#new-Vue-â€”-gt-createApp-ğŸš©-â•" class="headerlink" title="new Vue â€”&gt; createApp ğŸš© â•"></a>new Vue â€”&gt; createApp ğŸš© â•</h3><blockquote>
<p>vue2ä¸­æ²¡æœ‰app çš„æ¦‚å¿µï¼Œé€šè¿‡<code>Vue</code>çš„ç»Ÿä¸€æ„é€ å‡½æ•°è¿›è¡Œå…¨å±€çš„é…ç½®ï¼Œå•é¡µåº”ç”¨ä¸­æ— æ³•åˆ›å»ºå¤šä¸ªä¸åŒå…¨å±€é…ç½®çš„æ ¹åº”ç”¨ï¼ˆ<a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/global-api.html#%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%85%A8%E5%B1%80-api-createapp">ä¼šé€ æˆå…¨å±€é…ç½®æ±¡æŸ“</a>ï¼‰</p>
<p>vue3ä¸­æœ‰äº†appæ¦‚å¿µï¼Œé€šè¿‡<a href="https://github.com/vuejs/core/blob/4951d4352605eb9f4bcbea40ecc68fc6cbc3dce2/packages/runtime-dom/src/index.ts#L53">createApp</a>åˆ›å»ºè¿”å›çš„å®ä¾‹<strong>æš´éœ²å…¨å±€api</strong>ï¼Œè§£å†³äº†vue2ä¸­çš„é—®é¢˜</p>
</blockquote>
<ul>
<li><p>Vue2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">render</span>: <span class="function">(<span class="params">h</span>) =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Vue3</p>
<blockquote>
<p>createApp ç”Ÿæˆä¸€ä¸ªappå®ä¾‹ï¼Œè¯¥å®ä¾‹æ‹¥æœ‰å…¨å±€çš„å¯é…ç½®ä¸Šä¸‹æ–‡</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>


</li>
</ul>
<p>æ‰€ä»¥ç°åœ¨æ‰€æœ‰å…¨å±€ä¼šæ”¹å˜Vueè¡Œä¸ºçš„apiéƒ½æ”¹åˆ°äº†appåº”ç”¨å®ä¾‹ä¸Šäº†</p>
<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/Users/leo/Library/Application Support/typora-user-images/image-20220416124853316.png" alt="image-20220416124853316" style="zoom: 67%;">



<h3 id="internal-Apis-ğŸš©"><a href="#internal-Apis-ğŸš©" class="headerlink" title="internal Apis  ğŸš©"></a>internal Apis  ğŸš©</h3><p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/global-api-treeshaking.html#_2-x-%E8%AF%AD%E6%B3%95">æ–‡æ¡£</a></p>
<blockquote>
<p>vue2ä¸­ä¸å°‘global-apiæ˜¯ä½œä¸ºé™æ€å‡½æ•°ç›´æ¥æŒ‚åœ¨æ„é€ å‡½æ•°ä¸Šçš„ï¼Œä¾‹å¦‚<code>Vue.nextTick()</code>ï¼Œå¦‚æœæˆ‘ä»¬ä»æœªåœ¨ä»£ç ä¸­ç”¨è¿‡å®ƒä»¬ï¼Œå°±ä¼šå½¢æˆæ‰€è°“çš„<code>dead code</code>ï¼Œè¿™ç±»global-apié€ æˆçš„<code>dead code</code>æ— æ³•ä½¿ç”¨webpackçš„tree-shakingæ’é™¤æ‰ã€‚</p>
<p>vue3ä¸­åšäº†ç›¸åº”çš„å˜åŒ–ï¼Œå°†å®ƒä»¬æŠ½å–æˆä¸ºç‹¬ç«‹å‡½æ•°ï¼Œè¿™æ ·æ‰“åŒ…å·¥å…·çš„æ‘‡æ ‘ä¼˜åŒ–å¯ä»¥å°†è¿™äº›dead codeæ’é™¤æ‰ã€‚</p>
</blockquote>
<p>Vue2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">nextTick</span>(<span class="function">()=&gt;</span>&#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>Vue3</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹æ–‡æ¡£åˆ—å‡ºå—å½±å“çš„api</p>
<p>![image-20220416125617961](/Users/leo/Desktop/wengâ€™s code/wengâ€™blog/NollieLeo.github.io/source/_posts/vue2-vue3è¿ç§»è®°å½•/image-20220416125617961.png)</p>
<h3 id="app-config"><a href="#app-config" class="headerlink" title="app.config"></a><code>app.config</code></h3><h4 id="globalProperties-ğŸš©â•"><a href="#globalProperties-ğŸš©â•" class="headerlink" title="globalProperties  ğŸš©â•"></a><code>globalProperties</code>  ğŸš©â•</h4><blockquote>
<p>æ·»åŠ å¯åœ¨ç¨‹åºå†…çš„ä»»ä½•ç»„ä»¶å®ä¾‹ä¸­è®¿é—®çš„å…¨å±€å±æ€§ã€‚</p>
</blockquote>
<p>Vue2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure>

<p>vue3</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vue3</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;&#125;)</span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure>



<h4 id="devtools"><a href="#devtools" class="headerlink" title="devtools"></a><code>devtools</code></h4><blockquote>
<p>é…ç½®æ˜¯å¦å…è®¸ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvue-devtools">vue-devtools</a> æ£€æŸ¥ä»£ç ã€‚å¼€å‘ç‰ˆæœ¬é»˜è®¤ä¸º <code>true</code>ï¼Œç”Ÿäº§ç‰ˆæœ¬é»˜è®¤ä¸º <code>false</code>ã€‚ç”Ÿäº§ç‰ˆæœ¬è®¾ä¸º <code>true</code> å¯ä»¥å¯ç”¨æ£€æŸ¥ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">devtools</span> = <span class="literal">true</span></span><br><span class="line">+ app.<span class="property">config</span>.<span class="property">devtools</span> = <span class="literal">true</span>    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="errorHandler"><a href="#errorHandler" class="headerlink" title="errorHandler"></a><code>errorHandler</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">errorHandler</span> = <span class="keyword">function</span> (<span class="params">err, vm, info</span>) &#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">  <span class="comment">// `info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">  <span class="comment">// åªåœ¨ 2.2.0+ å¯ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line">+ app.<span class="property">config</span>.<span class="property">errorHandler</span> = <span class="function">(<span class="params">err, vm, info</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">  <span class="comment">// `info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">  <span class="comment">// è¿™é‡Œèƒ½å‘ç°é”™è¯¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŒ‡å®šç»„ä»¶çš„æ¸²æŸ“å’Œè§‚å¯ŸæœŸé—´æœªæ•è·é”™è¯¯çš„å¤„ç†å‡½æ•°ã€‚è¿™ä¸ªå¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯è·å–é”™è¯¯ä¿¡æ¯å’Œ Vue å®ä¾‹ã€‚</p>
</blockquote>
<blockquote>
<p>é”™è¯¯è¿½è¸ªæœåŠ¡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fsentry.io%2F">Sentry</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.bugsnag.com%2Fplatforms%2Fbrowsers%2Fvue%2F">Bugsnag</a> éƒ½é€šè¿‡æ­¤é€‰é¡¹æä¾›äº†å®˜æ–¹æ”¯æŒã€‚</p>
</blockquote>
<h4 id="warnHandler"><a href="#warnHandler" class="headerlink" title="warnHandler"></a><code>warnHandler</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">warnHandler</span> = <span class="keyword">function</span> (<span class="params">msg, vm, trace</span>) &#123;</span><br><span class="line">  <span class="comment">// `trace` æ˜¯ç»„ä»¶çš„ç»§æ‰¿å…³ç³»è¿½è¸ª</span></span><br><span class="line">&#125;</span><br><span class="line">+ app.<span class="property">config</span>.<span class="property">warnHandler</span> = <span class="keyword">function</span>(<span class="params">msg, vm, trace</span>) &#123;</span><br><span class="line">  <span class="comment">// `trace` æ˜¯ç»„ä»¶çš„ç»§æ‰¿å…³ç³»è¿½è¸ª</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸º Vue çš„è¿è¡Œæ—¶è­¦å‘Šèµ‹äºˆä¸€ä¸ªè‡ªå®šä¹‰å¤„ç†å‡½æ•°ã€‚æ³¨æ„è¿™åªä¼šåœ¨å¼€å‘è€…ç¯å¢ƒä¸‹ç”Ÿæ•ˆï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å®ƒä¼šè¢«å¿½ç•¥ã€‚</p>
</blockquote>
<h4 id="isCustomElement-â•"><a href="#isCustomElement-â•" class="headerlink" title="isCustomElement â•"></a><code>isCustomElement</code> â•</h4><ul>
<li>æ›¿ä»£æ‰Vue2.xçš„ignoredElements</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">ignoredElements</span> = [</span><br><span class="line">  <span class="comment">// ç”¨ä¸€ä¸ª `RegExp` å¿½ç•¥æ‰€æœ‰â€œion-â€å¼€å¤´çš„å…ƒç´ </span></span><br><span class="line">  <span class="comment">// ä»…åœ¨ 2.5+ æ”¯æŒ</span></span><br><span class="line">  <span class="regexp">/^ion-/</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€äº›ç»„ä»¶ä»¥&#x27;ion-&#x27;å¼€å¤´å°†ä¼šè¢«è§£æä¸ºè‡ªå®šä¹‰ç»„ä»¶</span></span><br><span class="line">+ app.<span class="property">config</span>.<span class="property">isCustomElement</span> = <span class="function"><span class="params">tag</span> =&gt;</span> tag.<span class="title function_">startsWith</span>(<span class="string">&#x27;ion-&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŒ‡å®šä¸€ä¸ªæ–¹æ³•æ¥è¯†åˆ«åœ¨Vueä¹‹å¤–å®šä¹‰çš„è‡ªå®šä¹‰ç»„ä»¶(ä¾‹å¦‚ï¼Œä½¿ç”¨<a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F08%2Fweb_components.html">Web Component API</a>)ã€‚å¦‚æœç»„ä»¶ç¬¦åˆè¿™ä¸ªæ¡ä»¶ï¼Œå®ƒå°±ä¸éœ€è¦æœ¬åœ°æˆ–å…¨å±€æ³¨å†Œï¼ŒVueä¹Ÿä¸ä¼šæŠ›å‡ºå…³äºUnknown custom elementçš„è­¦å‘Š</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°ä¸­ä¸éœ€è¦åŒ¹é…æ‰€æœ‰åŸç”ŸHTMLå’ŒSVGæ ‡è®°â€”Vueè§£æå™¨ä¼šè‡ªåŠ¨æ‰§è¡Œæ­¤æ£€æŸ¥</p>
</blockquote>
<h4 id="optionMergeStrategies"><a href="#optionMergeStrategies" class="headerlink" title="optionMergeStrategies"></a><code>optionMergeStrategies</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">hello</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="property">config</span>.<span class="property">optionMergeStrategies</span>.<span class="property">hello</span> = <span class="function">(<span class="params">parent, child, vm</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`Hello, <span class="subst">$&#123;child&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">  <span class="attr">hello</span>: <span class="string">&#x27;Vue&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x27;Hello, Vue</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®šä¹‰è‡ªå®šä¹‰é€‰é¡¹çš„åˆå¹¶ç­–ç•¥ã€‚</p>
<p>åˆå¹¶ç­–ç•¥æ¥æ”¶åœ¨<strong>çˆ¶å®ä¾‹</strong>optionså’Œâˆ—âˆ—å­å®ä¾‹âˆ—âˆ—optionså’Œ<strong>å­å®ä¾‹</strong>optionså’Œâˆ—âˆ—å­å®ä¾‹âˆ—âˆ—optionsï¼Œåˆ†åˆ«ä½œä¸ºç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ã€‚ä¸Šä¸‹æ–‡Vueå®ä¾‹ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’</p>
</blockquote>
<h5 id="ã€è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶ç­–ç•¥ã€‘mixin"><a href="#ã€è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶ç­–ç•¥ã€‘mixin" class="headerlink" title="ã€è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶ç­–ç•¥ã€‘mixin"></a>ã€è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶ç­–ç•¥ã€‘<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fdocs-next%2Fblob%2Fmaster%2Fsrc%2Fguide%2Fmixins.md%23custom-option-merge-strategies">mixin</a></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="attr">custom</span>: <span class="string">&#x27;hello!&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="property">config</span>.<span class="property">optionMergeStrategies</span>.<span class="property">custom</span> = <span class="function">(<span class="params">toVal, fromVal</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(fromVal, toVal)</span><br><span class="line">  <span class="comment">// =&gt; &quot;goodbye!&quot;, undefined</span></span><br><span class="line">  <span class="comment">// =&gt; &quot;hello!&quot;, &quot;goodbye!&quot;</span></span><br><span class="line">  <span class="keyword">return</span> fromVal || toVal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">  <span class="attr">custom</span>: <span class="string">&#x27;goodbye!&#x27;</span>,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">custom</span>) <span class="comment">// =&gt; &quot;hello!&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>optionMergeStrategieså…ˆè·å–åˆ°å­å®ä¾‹çš„$optionsçš„mixinè€Œæ²¡æœ‰çˆ¶å®ä¾‹ã€customç¬¬ä¸€æ¬¡æ”¹å˜ä»undefinedåˆ°goodbyeâ€”&gt;æ‰“å°â€goodbye!â€, undefinedã€‘</li>
<li>çˆ¶å®ä¾‹çš„optionsæ›¿æ¢æ‰å­å®ä¾‹çš„optionsæ›¿æ¢æ‰å­å®ä¾‹çš„optionsæ›¿æ¢æ‰å­å®ä¾‹çš„optionsã€customç¬¬äºŒæ¬¡ä»goodbyeåˆ°hello!â€”&gt;æ‰“å°äº†â€helloâ€, â€œgoodbye!â€ã€‘</li>
<li>æœ€ååœ¨æ‰“å°app.config.optionMergeStrategies.customè¿”å›çš„çˆ¶å®ä¾‹çš„$options</li>
</ul>
</blockquote>
<blockquote>
<p>æ— è®ºå¦‚ä½•this.options.customæœ€åä¼šè¿”å›åˆå¹¶ç­–ç•¥çš„returnçš„å€¼ã€ä½¿ç”¨åœºæ™¯åˆ©ç”¨çˆ¶å­ç»„ä»¶çš„options.customæœ€åä¼šè¿”å›åˆå¹¶ç­–ç•¥çš„returnçš„å€¼ã€ä½¿ç”¨åœºæ™¯åˆ©ç”¨çˆ¶å­ç»„ä»¶çš„options.customæœ€åä¼šè¿”å›åˆå¹¶ç­–ç•¥çš„returnçš„å€¼ã€ä½¿ç”¨åœºæ™¯åˆ©ç”¨çˆ¶å­ç»„ä»¶çš„options,ç„¶åè¿”å›è®¡ç®—ç­‰æ“ä½œå¾—åˆ°æ‰€éœ€è¦çš„å€¼ã€‘optionMergeStrategiesåˆå¹¶$optionså˜åŒ–</p>
</blockquote>
<h4 id="performance"><a href="#performance" class="headerlink" title="performance"></a><code>performance</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">performance</span>=<span class="literal">true</span>;</span><br><span class="line">+ app.<span class="property">config</span>.<span class="property">performance</span>=<span class="literal">true</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è®¾ç½®ä¸º true ä»¥åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·çš„æ€§èƒ½/æ—¶é—´çº¿é¢æ¿ä¸­å¯ç”¨å¯¹ç»„ä»¶åˆå§‹åŒ–ã€ç¼–è¯‘ã€æ¸²æŸ“å’Œæ‰“è¡¥ä¸çš„æ€§èƒ½è¿½è¸ªã€‚åªé€‚ç”¨äºå¼€å‘æ¨¡å¼å’Œæ”¯æŒ performance.mark API çš„æµè§ˆå™¨ä¸Šã€‚</p>
</blockquote>
<h3 id="app-directive"><a href="#app-directive" class="headerlink" title="app.directive"></a><code>app.directive</code></h3><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fdocs-next%2Fblob%2Fmaster%2Fsrc%2Fguide%2Fcustom-directive.md">æ•™ç¨‹æ–‡æ¡£</a></p>
</blockquote>
<blockquote>
<p>æ³¨å†Œæˆ–è·å–å…¨å±€æŒ‡ä»¤ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œ</span></span><br><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;my-directive&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">// æŒ‡ä»¤çš„ç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">  <span class="comment">// åœ¨ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶è¢«æŒ‚è½½ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">beforeMount</span>(<span class="params">el, binding, vnode</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// åœ¨æŒ‚è½½ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶æ—¶è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params">el, binding, vnode</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// åœ¨æ›´æ–°åŒ…å«ç»„ä»¶çš„VNodeä¹‹å‰è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">beforeUpdate</span>(<span class="params">el, binding, vnode, prevNode</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// ç»„ä»¶çš„VNodeåŠå…¶å­ç»„ä»¶çš„VNodeæ›´æ–°ä¹‹åè°ƒç”¨</span></span><br><span class="line">  <span class="title function_">updated</span>(<span class="params">el, binding, vnode, prevNode</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// åœ¨å¸è½½ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">beforeUnmount</span>(<span class="params">el, binding, vnode</span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// åœ¨å¸è½½ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶æ—¶è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">unmounted</span>(<span class="params">el, binding, vnode</span>) &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œ (æŒ‡ä»¤å‡½æ•°)</span></span><br><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;my-directive&#x27;</span>, <span class="function">(<span class="params">el, binding, vnode, prevNode</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå°†ä¼šè¢« `mounted` å’Œ `updated` è°ƒç”¨</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// getterï¼Œè¿”å›å·²æ³¨å†Œçš„æŒ‡ä»¤</span></span><br><span class="line"><span class="keyword">const</span> myDirective = app.<span class="title function_">directive</span>(<span class="string">&#x27;my-directive&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>el: æŒ‡ä»¤ç»‘å®šåˆ°çš„å…ƒç´ ã€‚è¿™å¯ä»¥ç”¨æ¥ç›´æ¥æ“ä½œDOMã€‚</p>
</li>
<li><p>bindingã€åŒ…å«ä¸‹åˆ—å±æ€§çš„å¯¹è±¡ã€‘</p>
<ul>
<li><p>instanceï¼šä½¿ç”¨æŒ‡ä»¤çš„ç»„ä»¶çš„å®ä¾‹</p>
</li>
<li><p>valueï¼šæŒ‡ä»¤çš„ç»‘å®šå€¼ï¼Œä¾‹å¦‚ï¼š<code>v-my-directive=&quot;1 + 1&quot;</code>ä¸­ï¼Œç»‘å®šå€¼ä¸º <code>2</code></p>
</li>
<li><p>oldValueï¼šæŒ‡ä»¤ç»‘å®šçš„å‰ä¸€ä¸ªå€¼ï¼Œä»…åœ¨ <code>beforeUpdate</code> å’Œ <code>updated</code> é’©å­ä¸­å¯ç”¨ã€‚æ— è®ºå€¼æ˜¯å¦æ”¹å˜éƒ½å¯ç”¨</p>
</li>
<li><p>argï¼šä¼ ç»™æŒ‡ä»¤çš„å‚æ•°ï¼Œå¯é€‰ã€‚ä¾‹å¦‚ <code>v-my-directive:foo</code> ä¸­ï¼Œå‚æ•°ä¸º <code>&quot;foo&quot;</code></p>
</li>
<li><p>modifiersï¼šä¸€ä¸ªåŒ…å«ä¿®é¥°ç¬¦çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š<code>v-my-directive.foo.bar</code> ä¸­ï¼Œä¿®é¥°ç¬¦å¯¹è±¡ä¸º <code>&#123; foo: true, bar: true &#125;</code></p>
</li>
<li><p>dirï¼šä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æ³¨å†ŒæŒ‡ä»¤æ—¶ä½œä¸ºå‚æ•°ä¼ é€’;  ä¸¾ä¸ªä¾‹å­ï¼Œçœ‹ä¸‹é¢æŒ‡ä»¤</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    el.<span class="title function_">focus</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>dirå°±æ˜¯ä¸‹é¢çš„å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  mounted(el) &#123;</span><br><span class="line">    el.focus()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>vnode</p>
<p>ç¼–è¯‘ç”Ÿæˆçš„è™šæ‹ŸèŠ‚ç‚¹</p>
</li>
<li><p>prevNode</p>
<p>å‰ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œä»…åœ¨beforeUpdateå’Œupdatedé’©å­ä¸­å¯ç”¨</p>
<blockquote>
<p>tips:é™¤äº† <code>el</code> ä¹‹å¤–ï¼Œå…¶å®ƒå‚æ•°éƒ½åº”è¯¥æ˜¯åªè¯»çš„ï¼Œåˆ‡å‹¿è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœéœ€è¦åœ¨é’©å­ä¹‹é—´å…±äº«æ•°æ®ï¼Œå»ºè®®é€šè¿‡å…ƒç´ çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FHTMLElement%2Fdataset"><code>dataset</code></a> æ¥è¿›è¡Œ</p>
</blockquote>
</li>
</ul>
<h3 id="app-unmount-ğŸš©â•"><a href="#app-unmount-ğŸš©â•" class="headerlink" title="app.unmount ğŸš©â•"></a><code>app.unmount</code> ğŸš©â•</h3><blockquote>
<p>åœ¨æ‰€æä¾›çš„DOMå…ƒç´ ä¸Šå¸è½½åº”ç”¨ç¨‹åºå®ä¾‹çš„æ ¹ç»„ä»¶</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;)</span><br><span class="line"><span class="comment">// åšä¸€äº›å¿…è¦çš„å‡†å¤‡</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#my-app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åº”ç”¨ç¨‹åºå°†åœ¨æŒ‚è½½å5ç§’è¢«å¸è½½</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> app.<span class="title function_">unmount</span>(<span class="string">&#x27;#my-app&#x27;</span>), <span class="number">5000</span>)</span><br></pre></td></tr></table></figure>



<h3 id="app-component"><a href="#app-component" class="headerlink" title="app.component"></a><code>app.component</code></h3><ul>
<li><p>Vue2.xã€æ³¨å†Œæˆ–è·å–å…¨å±€ç»„ä»¶ã€‚æ³¨å†Œè¿˜ä¼šè‡ªåŠ¨ä½¿ç”¨ç»™å®šçš„ <code>id</code> è®¾ç½®ç»„ä»¶çš„åç§°ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œç»„ä»¶ï¼Œä¼ å…¥ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ (è‡ªåŠ¨è°ƒç”¨ Vue.extend) </span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;my-component&#x27;</span>, &#123; <span class="comment">/* ... */</span> &#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ³¨å†Œçš„ç»„ä»¶ (å§‹ç»ˆè¿”å›æ„é€ å™¨) </span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">MyComponent</span> = <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;my-component&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>Vue3ã€æ³¨å†Œæˆ–è·å–å…¨å±€ç»„ä»¶. æ³¨å†Œè¿˜ä¼šè‡ªåŠ¨ä½¿ç”¨ç»™å®šçš„ nameç»„ä»¶ è®¾ç½®ç»„ä»¶çš„åç§°ã€‘<a href="https://link.juejin.cn?target=https%3A%2F%2Fcodepen.io%2Fteam%2FVue%2Fpen%2FrNVqYvM">å…¨å±€ç»„ä»¶</a></p>
<blockquote>
<p>åŸºæœ¬vue2å†™æ³•ä¸€è‡´</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œç»„ä»¶ï¼Œä¼ å…¥ä¸€ä¸ªé€‰é¡¹å¯¹è±¡</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;my-component&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ³¨å†Œçš„ç»„ä»¶ (å§‹ç»ˆè¿”å›æ„é€ å™¨) </span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyComponent</span> = app.<span class="title function_">component</span>(<span class="string">&#x27;my-component&#x27;</span>, &#123;&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><blockquote>
<p>ä»¥<code>.</code>åˆ†å‰²çš„è¡¨è¾¾å¼ä¸å†è¢«watchæ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨è®¡ç®—å‡½æ•°ä½œä¸º<em>w*</em>a<strong>t</strong>c*<em>h</em>æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨è®¡ç®—å‡½æ•°ä½œä¸ºwatchå‚æ•°å®ç°ã€‚</p>
</blockquote>
<p><strong>Vue2</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="string">&quot;data.id&quot;</span>(val) &#123;  </span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p><strong>Vue3</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>:<span class="number">121</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">watch</span>(data.<span class="property">id</span>,<span class="function">()=&gt;</span>&#123;&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="emits-â•"><a href="#emits-â•" class="headerlink" title="emits â•"></a>emits â•</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/emits-option.html#emits-%E9%80%89%E9%A1%B9">å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<ul>
<li>emits å¯ä»¥æ˜¯æ•°ç»„æˆ–å¯¹è±¡</li>
<li>è§¦å‘è‡ªå®šä¹‰äº‹ä»¶</li>
<li>å¦‚æœemitsæ˜¯å¯¹è±¡ï¼Œåˆ™å…è®¸æˆ‘ä»¬é…ç½®å’Œäº‹ä»¶éªŒè¯ã€‚éªŒè¯å‡½æ•°åº”è¿”å›å¸ƒå°”å€¼ï¼Œä»¥è¡¨ç¤ºäº‹ä»¶å‚æ•°æ˜¯å¦æœ‰æ•ˆã€‚</li>
</ul>
<h2 id="ä¾èµ–æ³¨å…¥provide-inject"><a href="#ä¾èµ–æ³¨å…¥provide-inject" class="headerlink" title="ä¾èµ–æ³¨å…¥provide/inject"></a>ä¾èµ–æ³¨å…¥provide/inject</h2><blockquote>
<p>ä¸vue2ä¸­ä½¿ç”¨æ–¹æ³•æ²¡æœ‰ä»€ä¹ˆå¾ˆå¤§çš„å·®å¼‚ï¼Œä½†æ˜¯äº®ç‚¹æ˜¯å¯ä»¥æä¾›ç›¸åº”å¼çš„æ•°æ®</p>
</blockquote>
<h3 id="åŸºç¡€ä½¿ç”¨æ–¹æ³•"><a href="#åŸºç¡€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="åŸºç¡€ä½¿ç”¨æ–¹æ³•"></a>åŸºç¡€ä½¿ç”¨æ–¹æ³•</h3><p>çœ‹æ–‡æ¡£</p>
<h3 id="å“åº”å¼æ–¹æ³•-ğŸš©â•"><a href="#å“åº”å¼æ–¹æ³•-ğŸš©â•" class="headerlink" title="å“åº”å¼æ–¹æ³•  ğŸš©â•"></a>å“åº”å¼æ–¹æ³•  ğŸš©â•</h3><p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æä¾›è€…</span></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> book = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Vue 3 Guide&#x27;</span>,</span><br><span class="line">    <span class="attr">author</span>: <span class="string">&#x27;Vue Team&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">const</span> year = <span class="title function_">ref</span>(<span class="string">&#x27;2020&#x27;</span>)</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*æä¾›reactiveå“åº”å¼*/</span></span><br><span class="line">  <span class="title function_">provide</span>(<span class="string">&#x27;book&#x27;</span>, book)</span><br><span class="line"> <span class="comment">/*æä¾›refå“åº”å¼*/</span></span><br><span class="line">  <span class="title function_">provide</span>(<span class="string">&#x27;year&#x27;</span>, year)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¼Šç«¯"><a href="#å¼Šç«¯" class="headerlink" title="å¼Šç«¯"></a>å¼Šç«¯</h4><p>æä¾›ç›¸åº”å¼çš„æ–¹æ³•ä¹‹åï¼Œå­ç»„å»ºå°±å¯ä»¥å°è¯•å¯¹è¿™ä¸ªå¼•ç”¨å€¼è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œå¯¼è‡´å•å‘æ•°æ®æµé€šçš„ç´Šä¹±</p>
<p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒåŸºäºprovideè¿›è¡Œå°è£…</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: ç¿æºæ•</span></span><br><span class="line"><span class="comment"> * @Date: 2022-04-10 16:11:32</span></span><br><span class="line"><span class="comment"> * @LastEditors: ç¿æºæ•</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-04-16 15:21:11</span></span><br><span class="line"><span class="comment"> * @FilePath: /vue3-vite-test/src/hooks/useProvide.ts</span></span><br><span class="line"><span class="comment"> * @Description: provide ï¼ˆobserverable provideï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide, readonly, reactive, ref, isReactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> forEach <span class="keyword">from</span> <span class="string">&quot;lodash/forEach&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useProvide</span> = (<span class="params">shouldReactive: <span class="built_in">Boolean</span> = <span class="literal">true</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> handleProvide = (<span class="attr">providers</span>: <span class="title class_">Record</span>&lt;string, any&gt;): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">forEach</span>(providers, <span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> provideValue;</span><br><span class="line">      <span class="keyword">const</span> isFunction = <span class="keyword">typeof</span> value === <span class="string">&quot;function&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> (!isFunction) &#123;</span><br><span class="line">        provideValue =</span><br><span class="line">          shouldReactive &amp;&amp; !<span class="title function_">isReactive</span>(value) ? <span class="title function_">ref</span>(value) : value;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">provide</span>(key, isFunction ? provideValue : <span class="title function_">readonly</span>(provideValue));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> handleProvide;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useProvide;</span><br></pre></td></tr></table></figure>



<h2 id="defineAsyncComponent-å¼‚æ­¥ç»„ä»¶"><a href="#defineAsyncComponent-å¼‚æ­¥ç»„ä»¶" class="headerlink" title="defineAsyncComponent(å¼‚æ­¥ç»„ä»¶)"></a>defineAsyncComponent(å¼‚æ­¥ç»„ä»¶)</h2><h1 id="ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h1><h2 id="ä¸-2-x-ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸç›¸å¯¹åº”çš„ç»„åˆå¼-API-ğŸš©â•"><a href="#ä¸-2-x-ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸç›¸å¯¹åº”çš„ç»„åˆå¼-API-ğŸš©â•" class="headerlink" title="ä¸ 2.x ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸç›¸å¯¹åº”çš„ç»„åˆå¼ API ğŸš©â•"></a><strong>ä¸ 2.x ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸç›¸å¯¹åº”çš„ç»„åˆå¼ API</strong> ğŸš©â•</h2><ul>
<li><del><code>beforeCreate</code></del> -&gt; ä½¿ç”¨ <code>setup()</code></li>
<li><del><code>created</code></del> -&gt; ä½¿ç”¨ <code>setup()</code></li>
<li><code>beforeMount</code> -&gt; <code>onBeforeMount</code></li>
<li><code>mounted</code> -&gt; <code>onMounted</code></li>
<li><code>beforeUpdate</code> -&gt; <code>onBeforeUpdate</code></li>
<li><code>updated</code> -&gt; <code>onUpdated</code></li>
<li><code>beforeDestroy</code> -&gt; <code>onBeforeUnmount</code></li>
<li><code>destroyed</code> -&gt; <code>onUnmounted</code></li>
<li><code>errorCaptured</code> -&gt; <code>onErrorCaptured</code></li>
</ul>
<h2 id="éç»„åˆå¼api"><a href="#éç»„åˆå¼api" class="headerlink" title="éç»„åˆå¼api"></a>éç»„åˆå¼api</h2><p>åªæ˜¯æ”¹äº†åå­—</p>
<h1 id="å†…ç½®æŒ‡ä»¤å˜åŒ–"><a href="#å†…ç½®æŒ‡ä»¤å˜åŒ–" class="headerlink" title="å†…ç½®æŒ‡ä»¤å˜åŒ–"></a>å†…ç½®æŒ‡ä»¤å˜åŒ–</h1><h2 id="v-model-ğŸš©"><a href="#v-model-ğŸš©" class="headerlink" title="v-model ğŸš©"></a><code>v-model</code> ğŸš©</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/component-basics.html#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BD%BF%E7%94%A8-v-model">å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<h3 id="ç»„ä»¶ä½¿ç”¨"><a href="#ç»„ä»¶ä½¿ç”¨" class="headerlink" title="ç»„ä»¶ä½¿ç”¨"></a>ç»„ä»¶ä½¿ç”¨</h3><p><strong>vue2 â€” v-model</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">ChildComponent</span> v-model=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- ç®€å†™: --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:value</span>=<span class="string">&quot;pageTitle&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦å°†å±æ€§æˆ–äº‹ä»¶åç§°æ›´æ”¹ä¸ºå…¶ä»–åç§°ï¼Œåˆ™éœ€è¦åœ¨ <code>ChildComponent</code> ç»„ä»¶ä¸­æ·»åŠ  <code>model</code> é€‰é¡¹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="title class_">ParentComponent</span>.<span class="property">vue</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ChildComponent.vue</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">prop</span>: <span class="string">&#x27;title&#x27;</span>,</span><br><span class="line">    <span class="attr">event</span>: <span class="string">&#x27;change&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="comment">// è¿™å°†å…è®¸ `value` å±æ€§ç”¨äºå…¶ä»–ç”¨é€”</span></span><br><span class="line">    <span class="attr">value</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ `title` ä»£æ›¿ `value` ä½œä¸º model çš„ prop</span></span><br><span class="line">    <span class="attr">title</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="string">&#x27;Default title&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ <code>v-model</code> çš„ç®€å†™å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">ChildComponent</span> :title=<span class="string">&quot;pageTitle&quot;</span> @change=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Vue2 â€” v-bind.sync</strong></p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹æŸä¸€ä¸ª prop è¿›è¡Œâ€œåŒå‘ç»‘å®šâ€(é™¤äº†å‰é¢ç”¨ <code>v-model</code> ç»‘å®š prop çš„æƒ…å†µ)ã€‚å»ºè®®ä½¿ç”¨ <code>update:myPropName</code> æŠ›å‡ºäº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå¯¹äºåœ¨ä¸Šä¸€ä¸ªç¤ºä¾‹ä¸­å¸¦æœ‰ <code>title</code> prop çš„ <code>ChildComponent</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å°†åˆ†é…æ–° value çš„æ„å›¾ä¼ è¾¾ç»™çˆ¶çº§ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;update:title&#x27;</span>, newValue)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœéœ€è¦çš„è¯ï¼Œçˆ¶çº§å¯ä»¥ç›‘å¬è¯¥äº‹ä»¶å¹¶æ›´æ–°æœ¬åœ° data propertyã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">ChildComponent</span> :title=<span class="string">&quot;pageTitle&quot;</span> @<span class="attr">update</span>:title=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>.sync</code> ä¿®é¥°ç¬¦æ¥ç¼©å†™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">ChildComponent</span> :title.<span class="property">sync</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Vue3 â€” v-model</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">ChildComponent</span> v-model=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- ç®€å†™: --&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:modelValue</span>=<span class="string">&quot;pageTitle&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">update:modelValue</span>=<span class="string">&quot;pageTitle = $event&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model:title</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- ç®€å†™: --&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:title</span>=<span class="string">&quot;pageTitle&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">update:title</span>=<span class="string">&quot;pageTitle = $event&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br></pre></td></tr></table></figure>



<h2 id="v-is-ğŸš©â•"><a href="#v-is-ğŸš©â•" class="headerlink" title="v-is ğŸš©â•"></a><code>v-is</code> ğŸš©â•</h2><blockquote>
<p>V-is ä»…é™äºindomçš„æ¨¡ç‰ˆ</p>
</blockquote>
<blockquote>
<p>Vue3ä¸­åªèƒ½ä½¿ç”¨isåœ¨å†…ç½®çš„componentç»„ä»¶ä¸Šé¢</p>
</blockquote>
<p><strong>vue2</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span> <span class="attr">:is</span>=<span class="string">&quot;&#x27;my-component&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>vue3</strong></p>
<blockquote>
<p>:isä¸å†é€‚ç”¨äºindomçš„æ¨¡ç‰ˆ</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-is</span>=<span class="string">&quot;&#x27;my-component&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="v-slot-ğŸš©â•"><a href="#v-slot-ğŸš©â•" class="headerlink" title="v-slot ğŸš©â•"></a><code>v-slot</code> ğŸš©â•</h2><blockquote>
<p>æ’æ§½åœ¨vue3ä¸­ç»Ÿä¸€äº†vue2çš„slotå’Œscope-slot</p>
</blockquote>
<p><strong>Vue2</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--Â Â å­ç»„ä»¶ä¸­ï¼š--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">slot</span>Â <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!--Â Â çˆ¶ç»„ä»¶ä¸­ï¼š--&gt;</span><br><span class="line">&lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">    &lt;h1&gt;æ­Œæ›²ï¼šæˆéƒ½&lt;/h1&gt;</span><br><span class="line">&lt;template&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬è¦<strong>åœ¨ slot ä¸Šé¢ç»‘å®šæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½</strong>ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­ç»„ä»¶</span></span><br><span class="line">&lt;slot name=<span class="string">&quot;content&quot;</span> :data=<span class="string">&quot;data&quot;</span>&gt;&lt;/slot&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            <span class="attr">data</span>:[<span class="string">&quot;èµ°è¿‡æ¥äººæ¥äººå¾€&quot;</span>,<span class="string">&quot;ä¸å–œæ¬¢ä¹Ÿå¾—æ¬£èµ&quot;</span>,<span class="string">&quot;é™ªä¼´æ˜¯æœ€é•¿æƒ…çš„å‘Šç™½&quot;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;</span><br><span class="line">&lt;template slot=&quot;content&quot; slot-scope=&quot;scoped&quot;&gt;</span><br><span class="line">    &lt;div v-for=&quot;item in scoped.data&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Vue3</strong></p>
<p>åœ¨ Vue2.x ä¸­å…·åæ’æ§½å’Œä½œç”¨åŸŸæ’æ§½åˆ†åˆ«ä½¿ç”¨<code>slot</code>å’Œ<code>slot-scope</code>æ¥å®ç°ï¼Œ åœ¨ Vue3.0 ä¸­å°†<code>slot</code>å’Œ<code>slot-scope</code>è¿›è¡Œäº†åˆå¹¶åŒæ„ä½¿ç”¨ã€‚ Vue3.0 ä¸­<code>v-slot</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;</span><br><span class="line"> &lt;template v-slot:content=&quot;scoped&quot;&gt;</span><br><span class="line">   &lt;div v-for=&quot;item in scoped.data&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- ä¹Ÿå¯ä»¥ç®€å†™æˆï¼š --&gt;</span><br><span class="line">&lt;template #content=&quot;&#123;data&#125;&quot;&gt;</span><br><span class="line">    &lt;div v-for=&quot;item in data&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>





<h1 id="è‡ªå®šä¹‰æŒ‡ä»¤å˜åŒ–-ğŸš©â•"><a href="#è‡ªå®šä¹‰æŒ‡ä»¤å˜åŒ–-ğŸš©â•" class="headerlink" title="è‡ªå®šä¹‰æŒ‡ä»¤å˜åŒ– ğŸš©â•"></a>è‡ªå®šä¹‰æŒ‡ä»¤å˜åŒ– ğŸš©â•</h1><p>vue3ä¸­æŒ‡ä»¤apiå’Œç»„ä»¶ä¿æŒä¸€è‡´ï¼Œå…·ä½“è¡¨ç°åœ¨ï¼š</p>
<ul>
<li>bind â†’ <strong>beforeMount</strong></li>
<li>inserted â†’ <strong>mounted</strong></li>
<li><strong>beforeUpdate</strong>: new! å…ƒç´ è‡ªèº«æ›´æ–°å‰è°ƒç”¨, å’Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­å¾ˆåƒ</li>
<li>update â†’ removed! å’ŒupdatedåŸºæœ¬ç›¸åŒï¼Œå› æ­¤è¢«ç§»é™¤ä¹‹ï¼Œä½¿ç”¨updatedä»£æ›¿ã€‚</li>
<li>componentUpdated â†’ <strong>updated</strong></li>
<li><strong>beforeUnmount</strong> new! å’Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ç›¸ä¼¼, å…ƒç´ å°†è¦è¢«ç§»é™¤ä¹‹å‰è°ƒç”¨ã€‚</li>
<li>unbind  â†’  <strong>unmounted</strong></li>
</ul>
<h1 id="å†…ç½®ç»„ä»¶"><a href="#å†…ç½®ç»„ä»¶" class="headerlink" title="å†…ç½®ç»„ä»¶"></a>å†…ç½®ç»„ä»¶</h1><h2 id="teleport-ğŸš©â•"><a href="#teleport-ğŸš©â•" class="headerlink" title="teleport ğŸš©â•"></a><code>teleport</code> ğŸš©â•</h2><p><a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/components/Teleport.ts">æºç </a></p>
<p><strong>Props</strong></p>
<ul>
<li><p><code>to</code> - <code>string</code> å¿…å¡«å±æ€§ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„queryé€‰æ‹©å™¨ï¼Œæˆ–è€…æ˜¯å…ƒç´ (å¦‚æœåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ä½¿ç”¨ï¼‰ã€‚ä¸­çš„å†…å®¹å°†ä¼šè¢«æ”¾ç½®åˆ°æŒ‡å®šçš„ç›®æ ‡å…ƒç´ ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- æ­£ç¡®çš„ --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;#some-id&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;.some-class&quot;</span> /&gt;</span></span></span><br><span class="line"> <span class="comment">/*å…ƒç´ */</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;[data-teleport]&quot;</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- é”™è¯¯çš„ --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;h1&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;some-string&quot;</span> /&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>disabled</code>  - <code>boolean</code> è¿™æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ ï¼Œåšä¸€ä¸ªæ˜¯å¯ä»¥ç”¨æ¥ç¦ç”¨çš„åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€å®ƒçš„æ’æ§½å†…å®¹ä¸ä¼šç§»åŠ¨åˆ°ä»»ä½•åœ°æ–¹ï¼Œè€Œæ˜¯æŒ‰æ²¡æœ‰<code>teleport</code>ç»„ä»¶ä¸€èˆ¬æ¥å‘ˆç°ã€é»˜è®¤ä¸ºfalseã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;teleport to=<span class="string">&quot;#popup&quot;</span> :disabled=<span class="string">&quot;displayVideoInline&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>999999<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&lt;/teleport&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™å°†ç§»åŠ¨å®é™…çš„DOMèŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯é”€æ¯å’Œé‡æ–°åˆ›å»ºï¼Œå¹¶ä¸”è¿˜å°†ä¿æŒä»»ä½•ç»„ä»¶å®ä¾‹æ˜¯æ´»åŠ¨çš„ã€‚æ‰€æœ‰æœ‰çŠ¶æ€HTMLå…ƒç´ (æ¯”å¦‚ä¸€ä¸ªæ­£åœ¨æ’­æ”¾çš„è§†é¢‘)å°†ä¿æŒå®ƒä»¬çš„çŠ¶æ€ã€‚ã€æ§åˆ¶displayVideoInlineå¹¶ä¸æ˜¯é”€æ¯é‡å»ºï¼Œå®ƒä¿æŒå®ä¾‹æ˜¯å­˜åœ¨çš„ï¼Œä¸ä¼šè¢«æ³¨é”€ã€‘</p>
</li>
</ul>
<h2 id="Suspense-ğŸš©â•"><a href="#Suspense-ğŸš©â•" class="headerlink" title="Suspense ğŸš©â•"></a><code>Suspense</code> ğŸš©â•</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/suspense.html#%E4%BB%8B%E7%BB%8D">å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<blockquote>
<p>å®˜æ–¹æ–‡æ¡£ç›®å‰è¿˜æ˜¯æ ‡æ³¨ä¸ºè¯•éªŒæ€§</p>
</blockquote>
<p>è¯¥ <code>&lt;suspense&gt;</code> ç»„ä»¶æä¾›äº†å¦ä¸€ä¸ªæ–¹æ¡ˆï¼Œå…è®¸å°†ç­‰å¾…è¿‡ç¨‹æå‡åˆ°ç»„ä»¶æ ‘ä¸­å¤„ç†ï¼Œè€Œä¸æ˜¯åœ¨å•ä¸ªç»„ä»¶ä¸­ã€‚</p>
<p>è‡ªå¸¦ä¸¤ä¸ª <code>slot</code> åˆ†åˆ«ä¸º <code>defaultã€fallback</code>ã€‚é¡¾åæ€ä¹‰ï¼Œå½“è¦åŠ è½½çš„ç»„ä»¶ä¸æ»¡è¶³çŠ¶æ€æ—¶,<code>Suspense</code> å°†å›é€€åˆ° <code>fallback</code>çŠ¶æ€ä¸€ç›´åˆ°åŠ è½½çš„ç»„ä»¶æ»¡è¶³æ¡ä»¶ï¼Œæ‰ä¼šè¿›è¡Œæ¸²æŸ“ã€‚</p>
<p>Suspense.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;loadAsyncComponent&quot;&gt;ç‚¹å‡»åŠ è½½å¼‚æ­¥ç»„ä»¶&lt;/button&gt;</span><br><span class="line">  &lt;Suspense v-if=&quot;loadAsync&quot;&gt;</span><br><span class="line">    &lt;template #default&gt;</span><br><span class="line">      &lt;!-- åŠ è½½å¯¹åº”çš„ç»„ä»¶ --&gt;</span><br><span class="line">      &lt;MAsynComp&gt;&lt;/MAsynComp&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template #fallback&gt;</span><br><span class="line">      &lt;div class=&quot;loading&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/Suspense&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, defineAsyncComponent &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    MAsynComp: defineAsyncComponent(() =&gt; import(&#x27;./AsynComp.vue&#x27;)),</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const loadAsync = ref(false)</span><br><span class="line">    const loadAsyncComponent = () =&gt; &#123;</span><br><span class="line">      loadAsync.value = true</span><br><span class="line">    &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">      loadAsync,</span><br><span class="line">      loadAsyncComponent,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">button &#123;</span><br><span class="line">  padding: 12px 12px;</span><br><span class="line">  background-color: #1890ff;</span><br><span class="line">  outline: none;</span><br><span class="line">  border: none;</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">  color: #fff;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line">.loading &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  width: 36px;</span><br><span class="line">  height: 36px;</span><br><span class="line">  top: 50%;</span><br><span class="line">  left: 50%;</span><br><span class="line">  margin: -18px 0 0 -18px;</span><br><span class="line">  background-image: url(&#x27;../assets/loading.png&#x27;);</span><br><span class="line">  background-size: 100%;</span><br><span class="line">  animation: rotate 1.4s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes rotate &#123;</span><br><span class="line">  from &#123;</span><br><span class="line">    transform: rotate(0);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    transform: rotate(360deg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>AsynComp.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;this is async component&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; setup &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;AsyncComponent&#x27;,</span><br><span class="line">  async setup() &#123;</span><br><span class="line">    const sleep = (time) =&gt; &#123;</span><br><span class="line">      return new Promise((reslove, reject) =&gt; &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">          reslove()</span><br><span class="line">        &#125;, time)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    await sleep(3000) //æ¨¡æ‹Ÿæ•°æ®è¯·æ±‚</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Fragments-ğŸš©â•"><a href="#Fragments-ğŸš©â•" class="headerlink" title="Fragments ğŸš©â•"></a><code>Fragments</code> ğŸš©â•</h2><p>Vue3.0ç»„ä»¶ä¸­å¯ä»¥å…è®¸æœ‰å¤šä¸ªæ ¹ç»„ä»¶ï¼Œé¿å…äº†å¤šä¸ªæ²¡å¿…è¦çš„divæ¸²æŸ“</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>å¤´éƒ¨<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>å†…å®¹<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ul>
<li>å°‘äº†å¾ˆå¤šæ²¡æœ‰æ„ä¹‰çš„div</li>
<li>å¯ä»¥å®ç°å¹³çº§é€’å½’ï¼Œå¯¹å®ç°treeç»„ä»¶æœ‰å¾ˆå¤§å¸®åŠ©</li>
</ul>
<h1 id="ç›¸åº”å¼ç³»ç»Ÿ-ğŸš©ğŸš©ğŸš©"><a href="#ç›¸åº”å¼ç³»ç»Ÿ-ğŸš©ğŸš©ğŸš©" class="headerlink" title="ç›¸åº”å¼ç³»ç»Ÿ ğŸš©ğŸš©ğŸš©"></a>ç›¸åº”å¼ç³»ç»Ÿ ğŸš©ğŸš©ğŸš©</h1><h2 id="å“åº”å¼ç³»ç»Ÿ-API"><a href="#å“åº”å¼ç³»ç»Ÿ-API" class="headerlink" title="å“åº”å¼ç³»ç»Ÿ API"></a>å“åº”å¼ç³»ç»Ÿ API</h2><h3 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a><code>reactive</code></h3><p>desc: æ¥æ”¶ä¸€ä¸ªæ™®é€šå¯¹è±¡ç„¶åè¿”å›è¯¥æ™®é€šå¯¹è±¡çš„å“åº”å¼ä»£ç†ã€ç­‰åŒäº 2.x çš„ <code>Vue.observable()</code>ã€‘</p>
<ul>
<li><p>ssss</p>
<p>tips:<code>Proxy</code>å¯¹è±¡æ˜¯ç›®æ ‡å¯¹è±¡çš„ä¸€ä¸ªä»£ç†å™¨ï¼Œä»»ä½•å¯¹ç›®æ ‡å¯¹è±¡çš„æ“ä½œï¼ˆå®ä¾‹åŒ–ï¼Œæ·»åŠ /åˆ é™¤/ä¿®æ”¹å±æ€§ç­‰ç­‰ï¼‰ï¼Œéƒ½å¿…é¡»é€šè¿‡è¯¥ä»£ç†å™¨ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠæ¥è‡ªå¤–ç•Œçš„æ‰€æœ‰æ“ä½œè¿›è¡Œæ‹¦æˆªå’Œè¿‡æ»¤æˆ–è€…ä¿®æ”¹ç­‰æ“ä½œ</p>
</li>
</ul>
<blockquote>
<p>å“åº”å¼è½¬æ¢æ˜¯â€œæ·±å±‚çš„â€ï¼šä¼šå½±å“å¯¹è±¡å†…éƒ¨æ‰€æœ‰åµŒå¥—çš„å±æ€§ã€‚åŸºäº ES2015 çš„ Proxy å®ç°ï¼Œè¿”å›çš„ä»£ç†å¯¹è±¡<strong>ä¸ç­‰äº</strong>åŸå§‹å¯¹è±¡ã€‚å»ºè®®ä»…ä½¿ç”¨ä»£ç†å¯¹è±¡è€Œé¿å…ä¾èµ–åŸå§‹å¯¹è±¡</p>
</blockquote>
<blockquote>
<p><code>reactive</code> ç±»çš„ api ä¸»è¦æä¾›äº†å°†å¤æ‚ç±»å‹çš„æ•°æ®å¤„ç†æˆå“åº”å¼æ•°æ®çš„èƒ½åŠ›ï¼Œå…¶å®è¿™ä¸ªå¤æ‚ç±»å‹æ˜¯è¦åœ¨<code>object array map set weakmap weakset</code> è¿™äº”ç§ä¹‹ä¸­</p>
</blockquote>
<blockquote>
<p>å› ä¸ºæ˜¯ç»„åˆå‡½æ•°ã€å¯¹è±¡ã€‘ï¼Œæ‰€ä»¥å¿…é¡»å§‹ç»ˆä¿æŒå¯¹è¿™ä¸ªæ‰€è¿”å›å¯¹è±¡çš„å¼•ç”¨ä»¥ä¿æŒå“åº”æ€§ã€ä¸èƒ½è§£æ„è¯¥å¯¹è±¡æˆ–è€…å±•å¼€ã€‘ä¾‹å¦‚ <code>const &#123; x, y &#125; = useMousePosition()</code>æˆ–è€…<code>return &#123; ...useMousePosition() &#125;</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useMousePosition</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pos = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> pos</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html#torefs"><code>toRefs</code></a> API ç”¨æ¥æä¾›è§£å†³æ­¤çº¦æŸçš„åŠæ³•â€”â€”å®ƒå°†å“åº”å¼å¯¹è±¡çš„æ¯ä¸ª property éƒ½è½¬æˆäº†ç›¸åº”çš„ refã€æŠŠå¯¹è±¡è½¬æˆäº†refã€‘ã€‚</p>
<blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">function</span> <span class="title function_">useMousePosition</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pos = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">toRefs</span>(pos)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// x &amp; y ç°åœ¨æ˜¯ ref å½¢å¼äº†!</span></span><br><span class="line"><span class="keyword">const</span> &#123; x, y &#125; = <span class="title function_">useMousePosition</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a><code>ref</code></h3><p>æ¥å—ä¸€ä¸ªå‚æ•°å€¼å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼ä¸”å¯æ”¹å˜çš„ ref å¯¹è±¡ã€‚ref å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªæŒ‡å‘å†…éƒ¨å€¼çš„å•ä¸€å±æ€§ <code>.value</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(count.<span class="property">value</span>) <span class="comment">// 0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœä¼ å…¥ ref çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†è°ƒç”¨ <code>reactive</code> æ–¹æ³•è¿›è¡Œæ·±å±‚å“åº”è½¬æ¢</p>
</blockquote>
<h4 id="é™·é˜±"><a href="#é™·é˜±" class="headerlink" title="é™·é˜±"></a>é™·é˜±</h4><ul>
<li><code>setup</code> ä¸­<code>return</code>è¿”å›ä¼šè‡ªåŠ¨è§£å¥—ã€åœ¨æ¨¡æ¿ä¸­ä¸éœ€è¦<code>.value</code>ã€‘</li>
</ul>
<ul>
<li><p>ref ä½œä¸º reactive å¯¹è±¡çš„ property è¢«è®¿é—®æˆ–ä¿®æ”¹æ—¶ï¼Œä¹Ÿå°†è‡ªåŠ¨è§£å¥— <code>.value</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="comment">/*å½“åšreactiveçš„å¯¹è±¡å±æ€§----è§£å¥—*/</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  count,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">/* ä¸éœ€è¦.value*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">count</span>) <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*ä¿®æ”¹reactiveçš„å€¼*/</span></span><br><span class="line">state.<span class="property">count</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">/*ä¿®æ”¹äº†refçš„å€¼*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(count.<span class="property">value</span>) <span class="comment">// 1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„å¦‚æœå°†ä¸€ä¸ªæ–°çš„ ref åˆ†é…ç»™ç°æœ‰çš„ refï¼Œ å°†æ›¿æ¢æ—§çš„ ref</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*åˆ›å»ºä¸€ä¸ªæ–°çš„ref*/</span></span><br><span class="line"><span class="keyword">const</span> otherCount = <span class="title function_">ref</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*èµ‹å€¼ç»™reactiveçš„æ—§çš„refï¼Œæ—§çš„ä¼šè¢«æ›¿æ¢æ‰*/</span></span><br><span class="line">state.<span class="property">count</span> = otherCount</span><br><span class="line"><span class="comment">/*ä¿®æ”¹reactiveä¼šä¿®æ”¹otherCount*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">count</span>) <span class="comment">// 2</span></span><br><span class="line"><span class="comment">/*ä¿®æ”¹reactiveä¼šcountæ²¡æœ‰è¢«ä¿®æ”¹ */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(count.<span class="property">value</span>) <span class="comment">// 1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>åµŒå¥—åœ¨ reactive <code>Object</code> ä¸­æ—¶ï¼Œref æ‰ä¼šè§£å¥—ã€‚ä» <code>Array</code> æˆ–è€… <code>Map</code> ç­‰åŸç”Ÿé›†åˆç±»ä¸­è®¿é—® ref æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨è§£å¥—ã€è‡ªç”±æ•°æ®ç±»å‹æ˜¯Objectæ‰ä¼šè§£å¥—ï¼Œ<code>array</code> <code>map</code> <code>set</code>  <code>weakmap</code> <code>weakset</code>é›†åˆç±» <strong>è®¿é—® ref æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨è§£å¥—</strong>ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = <span class="title function_">reactive</span>([<span class="title function_">ref</span>(<span class="number">0</span>)])</span><br><span class="line"><span class="comment">// è¿™é‡Œéœ€è¦ .value</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">0</span>].<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map = <span class="title function_">reactive</span>(<span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;foo&#x27;</span>, <span class="title function_">ref</span>(<span class="number">0</span>)]]))</span><br><span class="line"><span class="comment">// è¿™é‡Œéœ€è¦ .value</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(<span class="string">&#x27;foo&#x27;</span>).<span class="property">value</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="å¿ƒæ™ºè´Ÿæ‹…ä¸Š-ref-vs-reactive"><a href="#å¿ƒæ™ºè´Ÿæ‹…ä¸Š-ref-vs-reactive" class="headerlink" title="å¿ƒæ™ºè´Ÿæ‹…ä¸Š ref  vs  reactive"></a>å¿ƒæ™ºè´Ÿæ‹…ä¸Š <code>ref</code>  vs  <code>reactive</code></h4><ul>
<li>åœ¨æ™®é€š JavaScript ä¸­åŒºåˆ«<code>å£°æ˜åŸºç¡€ç±»å‹å˜é‡</code>ä¸<code>å¯¹è±¡å˜é‡</code>æ—¶ä¸€æ ·åŒºåˆ«ä½¿ç”¨ <code>ref</code> å’Œ <code>reactive</code></li>
<li>æ‰€æœ‰çš„åœ°æ–¹éƒ½ç”¨ <code>reactive</code>ï¼Œç„¶åè®°å¾—åœ¨ç»„åˆå‡½æ•°è¿”å›å“åº”å¼å¯¹è±¡æ—¶ä½¿ç”¨ <code>toRefs</code>ã€‚è¿™é™ä½äº†ä¸€äº›å…³äº ref çš„å¿ƒæ™ºè´Ÿæ‹…</li>
</ul>
<h3 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a><code>readonly</code></h3><p>ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼ˆå“åº”å¼æˆ–æ™®é€šï¼‰æˆ– refï¼Œè¿”å›ä¸€ä¸ªåŸå§‹å¯¹è±¡çš„<strong>åªè¯»</strong>ä»£ç†ã€‚ä¸€ä¸ªåªè¯»çš„ä»£ç†æ˜¯â€œæ·±å±‚çš„â€ï¼Œå¯¹è±¡å†…éƒ¨ä»»ä½•åµŒå¥—çš„å±æ€§ä¹Ÿéƒ½æ˜¯åªè¯»çš„ã€è¿”å›ä¸€ä¸ªæ°¸è¿œä¸ä¼šå˜çš„åªè¯»ä»£ç†ã€‘ã€åœºæ™¯å¯ä»¥å‚æ•°æ¯”å¯¹ç­‰ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> original = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> copy = <span class="title function_">readonly</span>(original)</span><br><span class="line"></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ä¾èµ–è¿½è¸ª</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(copy.<span class="property">count</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// original ä¸Šçš„ä¿®æ”¹ä¼šè§¦å‘ copy ä¸Šçš„ä¾¦å¬</span></span><br><span class="line">original.<span class="property">count</span>++</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— æ³•ä¿®æ”¹ copy å¹¶ä¼šè¢«è­¦å‘Š</span></span><br><span class="line">copy.<span class="property">count</span>++ <span class="comment">// warning!</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="reactiveå“åº”å¼ç³»ç»Ÿå·¥å…·é›†"><a href="#reactiveå“åº”å¼ç³»ç»Ÿå·¥å…·é›†" class="headerlink" title="reactiveå“åº”å¼ç³»ç»Ÿå·¥å…·é›†"></a><code>reactive</code>å“åº”å¼ç³»ç»Ÿå·¥å…·é›†</h2><h3 id="isProxy"><a href="#isProxy" class="headerlink" title="isProxy"></a><code>isProxy</code></h3><blockquote>
<p>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”± <code>reactive</code> æˆ–è€… <code>readonly</code> æ–¹æ³•åˆ›å»ºçš„ä»£ç†</p>
</blockquote>
<h3 id="isReactive"><a href="#isReactive" class="headerlink" title="isReactive"></a><code>isReactive</code></h3><blockquote>
<p>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”± <code>reactive</code> åˆ›å»ºçš„å“åº”å¼ä»£ç†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, isReactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(state)) <span class="comment">// -&gt; true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>å¦‚æœè¿™ä¸ªä»£ç†æ˜¯ç”± <code>readonly</code> åˆ›å»ºçš„ï¼Œä½†æ˜¯åˆè¢« <code>reactive</code> åˆ›å»ºçš„å¦ä¸€ä¸ªä»£ç†åŒ…è£¹äº†ä¸€å±‚ï¼Œé‚£ä¹ˆåŒæ ·ä¹Ÿä¼šè¿”å› <code>true</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, isReactive, readonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="comment">// ç”¨readonlyåˆ›å»ºä¸€ä¸ªåªè¯»å“åº”å¼å¯¹è±¡plain</span></span><br><span class="line"><span class="keyword">const</span> plain = <span class="title function_">readonly</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Mary&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//readonlyåˆ›å»ºçš„ï¼Œæ‰€ä»¥isReactiveä¸ºfalse</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(plain)) <span class="comment">// -&gt; false  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// reactiveåˆ›å»ºçš„å“åº”å¼ä»£ç†å¯¹è±¡åŒ…è£¹ä¸€å±‚readonly,isReactiveä¹Ÿæ˜¯true,isReadonlyä¹Ÿæ˜¯true</span></span><br><span class="line"><span class="keyword">const</span> stateCopy = <span class="title function_">readonly</span>(state)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(stateCopy)) <span class="comment">// -&gt; true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="isReadonly"><a href="#isReadonly" class="headerlink" title="isReadonly"></a><code>isReadonly</code></h3><blockquote>
<p>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”± <code>readonly</code> åˆ›å»ºçš„åªè¯»ä»£ç†</p>
</blockquote>
<h2 id="reactiveé«˜çº§å“åº”å¼ç³»ç»ŸAPI"><a href="#reactiveé«˜çº§å“åº”å¼ç³»ç»ŸAPI" class="headerlink" title="reactiveé«˜çº§å“åº”å¼ç³»ç»ŸAPI"></a><code>reactive</code>é«˜çº§å“åº”å¼ç³»ç»ŸAPI</h2><h3 id="toRaw"><a href="#toRaw" class="headerlink" title="toRaw"></a><code>toRaw</code></h3><blockquote>
<p>è¿”å›ç”± <code>reactive</code> æˆ– <code>readonly</code> æ–¹æ³•è½¬æ¢æˆå“åº”å¼ä»£ç†çš„æ™®é€šå¯¹è±¡ã€‚è¿™æ˜¯ä¸€ä¸ªè¿˜åŸæ–¹æ³•ï¼Œå¯ç”¨äºä¸´æ—¶è¯»å–ï¼Œè®¿é—®ä¸ä¼šè¢«ä»£ç†/è·Ÿè¸ªï¼Œå†™å…¥æ—¶ä¹Ÿä¸ä¼šè§¦å‘æ›´æ”¹ã€‚ä¸å»ºè®®ä¸€ç›´æŒæœ‰åŸå§‹å¯¹è±¡çš„å¼•ç”¨ã€<code>**ä¸å»ºè®®èµ‹å€¼ç»™ä»»ä½•å˜é‡**</code>ã€‘ã€‚è¯·è°¨æ…ä½¿ç”¨</p>
</blockquote>
<p>è¢«<strong><code>toRaw</code></strong>ä¹‹åçš„å¯¹è±¡æ˜¯æ²¡æœ‰è¢«ä»£ç†/è·Ÿè¸ªçš„çš„æ™®é€šå¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> reactiveFoo = <span class="title function_">reactive</span>(foo)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">toRaw</span>(reactiveFoo) === foo) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">toRaw</span>(reactiveFoo) !== reactiveFoo) <span class="comment">// true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="markRaw"><a href="#markRaw" class="headerlink" title="markRaw"></a><code>markRaw</code></h3><p>æ˜¾å¼æ ‡è®°ä¸€ä¸ªå¯¹è±¡ä¸ºâ€œæ°¸è¿œä¸ä¼šè½¬ä¸ºå“åº”å¼ä»£ç†â€ï¼Œå‡½æ•°è¿”å›è¿™ä¸ªå¯¹è±¡æœ¬èº«ã€‚</p>
<blockquote>
<p>ã€<code>markRaw</code>ä¼ å…¥å¯¹è±¡ï¼Œè¿”å›çš„å€¼æ˜¯æ°¸è¿œä¸ä¼šè¢«è½¬ä¸ºå“åº”å¼ä»£ç†çš„ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="title function_">markRaw</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Mary&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(<span class="title function_">reactive</span>(foo))) <span class="comment">// false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>è¢« markRaw æ ‡è®°äº†ï¼Œå³ä½¿åœ¨å“åº”å¼å¯¹è±¡ä¸­ä½œå±æ€§ï¼Œä¹Ÿä¾ç„¶ä¸æ˜¯å“åº”å¼çš„</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="title function_">reactive</span>(&#123; foo &#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(bar.<span class="property">foo</span>)) <span class="comment">// false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="markRawæ³¨æ„ç‚¹"><a href="#markRawæ³¨æ„ç‚¹" class="headerlink" title="markRawæ³¨æ„ç‚¹"></a><code>markRaw</code>æ³¨æ„ç‚¹</h4><ul>
<li><p>markRawå’Œ shallowXXX ä¸€æ—çš„ APIå…è®¸<strong>é€‰æ‹©æ€§çš„</strong>è¦†ç›–reactiveæˆ–è€…readonly é»˜è®¤åˆ›å»ºçš„ â€œæ·±å±‚çš„â€ ç‰¹æ€§ã€å“åº”å¼ã€‘/æˆ–è€…ä½¿ç”¨æ— ä»£ç†çš„æ™®é€šå¯¹è±¡</p>
</li>
<li><p>è®¾è®¡è¿™ç§ã€Œæµ…å±‚è¯»å–ã€æœ‰å¾ˆå¤šåŸå› </p>
<ul>
<li>ä¸€äº›å€¼çš„å®é™…ä¸Šçš„ç”¨æ³•éå¸¸ç®€å•ï¼Œå¹¶æ²¡æœ‰å¿…è¦è½¬ä¸ºå“åº”å¼ã€ä¾‹å¦‚ä¸‰æ–¹åº“çš„å®ä¾‹/çœå¸‚åŒºjson/Vueç»„ä»¶å¯¹è±¡ã€‘</li>
<li>å½“æ¸²æŸ“ä¸€ä¸ªå…ƒç´ æ•°é‡åºå¤§ï¼Œä½†æ˜¯æ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œè·³è¿‡ Proxy çš„è½¬æ¢å¯ä»¥å¸¦æ¥æ€§èƒ½æå‡</li>
</ul>
</li>
<li><p>è¿™äº› API è¢«è®¤ä¸ºæ˜¯é«˜çº§çš„ï¼Œæ˜¯å› ä¸ºè¿™ç§ç‰¹æ€§ä»…åœç•™åœ¨æ ¹çº§åˆ«ï¼Œæ‰€ä»¥å¦‚æœä½ å°†ä¸€ä¸ªåµŒå¥—çš„ï¼Œæ²¡æœ‰ <code>markRaw</code> çš„å¯¹è±¡è®¾ç½®ä¸º reactive å¯¹è±¡çš„å±æ€§ï¼Œåœ¨é‡æ–°è®¿é—®æ—¶ï¼Œä½ åˆä¼šå¾—åˆ°ä¸€ä¸ª Proxy çš„ç‰ˆæœ¬ï¼Œåœ¨ä½¿ç”¨ä¸­æœ€ç»ˆä¼šå¯¼è‡´<strong>æ ‡è¯†æ··æ·†</strong>çš„ä¸¥é‡é—®é¢˜ï¼šæ‰§è¡ŒæŸä¸ªæ“ä½œåŒæ—¶ä¾èµ–äºæŸä¸ªå¯¹è±¡çš„åŸå§‹ç‰ˆæœ¬å’Œä»£ç†ç‰ˆæœ¬ï¼ˆæ ‡è¯†æ··æ·†åœ¨ä¸€èˆ¬ä½¿ç”¨å½“ä¸­åº”è¯¥æ˜¯éå¸¸ç½•è§çš„ï¼Œä½†æ˜¯è¦æƒ³å®Œå…¨é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œå¿…é¡»è¦å¯¹æ•´ä¸ªå“åº”å¼ç³»ç»Ÿçš„å·¥ä½œåŸç†æœ‰ä¸€ä¸ªç›¸å½“æ¸…æ™°çš„è®¤çŸ¥ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="title function_">markRaw</span>(&#123;</span><br><span class="line">  <span class="attr">nested</span>: &#123;&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="comment">// å°½ç®¡ `foo` å·±ç»è¢«æ ‡è®°ä¸º raw äº†, ä½† foo.nested å¹¶æ²¡æœ‰</span></span><br><span class="line">  <span class="attr">nested</span>: foo.<span class="property">nested</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">nested</span> === bar.<span class="property">nested</span>) <span class="comment">// false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>foo.nestedæ²¡æœ‰è¢«æ ‡è®°ä¸º(æ°¸è¿œä¸ä¼šè½¬ä¸ºå“åº”å¼ä»£ç†)ï¼Œå¯¼è‡´æœ€åçš„å€¼ä¸€ä¸ªreactive</li>
</ul>
</li>
</ul>
<h3 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a><code>shallowReactive</code></h3><p>åªä¸ºæŸä¸ªå¯¹è±¡çš„ç§æœ‰ï¼ˆç¬¬ä¸€å±‚ï¼‰å±æ€§åˆ›å»ºæµ…å±‚çš„å“åº”å¼ä»£ç†ï¼Œä¸ä¼šå¯¹â€œå±æ€§çš„å±æ€§â€åšæ·±å±‚æ¬¡ã€é€’å½’åœ°å“åº”å¼ä»£ç†ï¼Œè€Œåªæ˜¯ä¿ç•™åŸæ ·ã€ç¬¬ä¸€å±‚æ˜¯å“åº”å¼ä»£ç†ï¼Œæ·±å±‚æ¬¡åªä¿ç•™åŸæ ·(ä¸å…·å¤‡å“åº”å¼ä»£ç†)ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowReactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">nested</span>: &#123;</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜æ›´ state çš„è‡ªæœ‰å±æ€§æ˜¯å“åº”å¼çš„ã€ç¬¬ä¸€å±‚æ¬¡å“åº”å¼ã€‘</span></span><br><span class="line">state.<span class="property">foo</span>++</span><br><span class="line"><span class="comment">// ...ä½†ä¸ä¼šæ·±å±‚ä»£ç†ã€æ·±å±‚æ¬¡ä¸æ˜¯å“åº”å¼ã€‘(æ¸²æŸ“æ€§èƒ½)</span></span><br><span class="line"><span class="title function_">isReactive</span>(state.<span class="property">nested</span>) <span class="comment">// false</span></span><br><span class="line">state.<span class="property">nested</span>.<span class="property">bar</span>++ <span class="comment">// éå“åº”å¼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shallowReadonly"><a href="#shallowReadonly" class="headerlink" title="shallowReadonly"></a><code>shallowReadonly</code></h3><p>ç±»ä¼¼äº<code>shallowReactive</code>ï¼ŒåŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li>ç¬¬ä¸€å±‚å°†ä¼šæ˜¯å“åº”å¼ä»£ç†ã€ç¬¬ä¸€å±‚ä¿®æ”¹å±æ€§ä¼šå¤±è´¥ã€‘ï¼Œå±æ€§ä¸ºå“åº”å¼</li>
<li>æ·±å±‚æ¬¡çš„å¯¹è±¡å±æ€§å¯ä»¥ä¿®æ”¹ï¼Œå±æ€§ä¸æ˜¯å“åº”å¼</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowReadonly</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">nested</span>: &#123;</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜æ›´ state çš„è‡ªæœ‰å±æ€§ä¼šå¤±è´¥</span></span><br><span class="line">state.<span class="property">foo</span>++</span><br><span class="line"><span class="comment">// ...ä½†æ˜¯åµŒå¥—çš„å¯¹è±¡æ˜¯å¯ä»¥å˜æ›´çš„</span></span><br><span class="line"><span class="title function_">isReadonly</span>(state.<span class="property">nested</span>) <span class="comment">// false</span></span><br><span class="line">state.<span class="property">nested</span>.<span class="property">bar</span>++ <span class="comment">// åµŒå¥—å±æ€§ä¾ç„¶å¯ä¿®æ”¹</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ref-å“åº”å¼ç³»ç»Ÿå·¥å…·é›†"><a href="#ref-å“åº”å¼ç³»ç»Ÿå·¥å…·é›†" class="headerlink" title="ref å“åº”å¼ç³»ç»Ÿå·¥å…·é›†"></a><code>ref</code> å“åº”å¼ç³»ç»Ÿå·¥å…·é›†</h2><h3 id="unref"><a href="#unref" class="headerlink" title="unref"></a><code>unref</code></h3><p><code>unref</code>æ˜¯<code>val = isRef(val) ? val.value : val</code> çš„è¯­æ³•ç³–</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">unref</span>(<span class="title function_">ref</span>(<span class="number">0</span>))===<span class="title function_">unref</span>(<span class="number">0</span>)===<span class="number">0</span>   è¿”å›number</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useFoo</span>(<span class="params">x: number | Ref&lt;number&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> unwrapped = <span class="title function_">unref</span>(x) <span class="comment">// unwrapped ä¸€å®šæ˜¯ number ç±»å‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a><code>toRef</code></h3><p><code>toRef</code> å¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ª reactive å¯¹è±¡çš„<code>å±æ€§</code>ã€æŸä¸ªå±æ€§åŒºåˆ«toRefsæ¯ä¸€ä¸ªå±æ€§ã€‘åˆ›å»ºä¸€ä¸ª refã€‚è¿™ä¸ª ref å¯ä»¥è¢«ä¼ é€’å¹¶ä¸”èƒ½å¤Ÿä¿æŒå“åº”æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//reactiveè·å–å•ä¸ªå±æ€§è½¬ä¸ºrefã€fooRefåªæ˜¯ä¸€ä¸ªä»£ç†ã€‘</span></span><br><span class="line"><span class="keyword">const</span> fooRef = <span class="title function_">toRef</span>(state, <span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fooRef.<span class="property">value</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">foo</span>) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">state.<span class="property">foo</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fooRef.<span class="property">value</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a><code>toRefs</code></h3><p>æŠŠä¸€ä¸ªå“åº”å¼å¯¹è±¡è½¬æ¢æˆæ™®é€šå¯¹è±¡ï¼Œè¯¥æ™®é€šå¯¹è±¡çš„æ¯ä¸ª property éƒ½æ˜¯ä¸€ä¸ª ref ï¼Œå’Œå“åº”å¼å¯¹è±¡ property ä¸€ä¸€å¯¹åº”</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stateAsRefs = <span class="title function_">toRefs</span>(state)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">stateAsRefs çš„ç±»å‹å¦‚ä¸‹:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  foo: Ref&lt;number&gt;,</span></span><br><span class="line"><span class="comment">  bar: Ref&lt;number&gt;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ref å¯¹è±¡ ä¸ åŸå±æ€§çš„å¼•ç”¨æ˜¯ &quot;é“¾æ¥&quot; ä¸Šçš„</span></span><br><span class="line">state.<span class="property">foo</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stateAsRefs.<span class="property">foo</span>) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">stateAsRefs.<span class="property">foo</span>.<span class="property">value</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">foo</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥é€šè¿‡<code>toRefs</code>è¿”å›å¯è§£æ„çš„reactiveï¼Œå› ä¸º<code>toRefs</code>åŒ…è£¹ä¹‹åè¿”å›ä¸€ä¸€å¯¹åº”çš„refå±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useFeatureX</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹ state çš„é€»è¾‘æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›æ—¶å°†å±æ€§éƒ½è½¬ä¸º ref</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">toRefs</span>(state)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è§£æ„ï¼Œä¸ä¼šä¸¢å¤±å“åº”æ€§</span></span><br><span class="line">    <span class="keyword">const</span> &#123; foo, bar &#125; = <span class="title function_">useFeatureX</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      foo,</span><br><span class="line">      bar,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a><code>isRef</code></h3><p>æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºä¸€ä¸ª ref å¯¹è±¡</p>
<h2 id="ref-é«˜çº§å“åº”å¼ç³»ç»ŸAPI"><a href="#ref-é«˜çº§å“åº”å¼ç³»ç»ŸAPI" class="headerlink" title="ref é«˜çº§å“åº”å¼ç³»ç»ŸAPI"></a><code>ref</code> é«˜çº§å“åº”å¼ç³»ç»ŸAPI</h2><h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a><code>customRef</code></h3><p>ç”¨äºè‡ªå®šä¹‰ä¸€ä¸ª <code>ref</code>ï¼Œå¯ä»¥æ˜¾å¼åœ°æ§åˆ¶ä¾èµ–è¿½è¸ªå’Œè§¦å‘å“åº”ï¼Œæ¥å—ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ç”¨äºè¿½è¸ªçš„ <code>track</code> ä¸ç”¨äºè§¦å‘å“åº”çš„ <code>trigger</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ªä¸€ä¸ªå¸¦æœ‰ <code>get</code> å’Œ <code>set</code> å±æ€§çš„å¯¹è±¡ã€å®é™…ä¸Šå°±æ˜¯æ‰‹åŠ¨ <code>track</code>è¿½è¸ª å’Œ <code>trigger</code>è§¦å‘å“åº”ã€‘</p>
<ul>
<li>ä»¥ä¸‹ä»£ç å¯ä»¥ä½¿å¾—v-modelé˜²æŠ–</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useDebouncedRef</span>(<span class="params">value, delay = <span class="number">200</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeout</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">customRef</span>(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="comment">/*åˆå§‹åŒ–æ‰‹åŠ¨è¿½è¸ªä¾èµ–è®²ç©¶ä»€ä¹ˆæ—¶å€™å»è§¦å‘ä¾èµ–æ”¶é›†*/</span></span><br><span class="line">        <span class="title function_">track</span>()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">          <span class="comment">/*ä¿®æ”¹æ•°æ®çš„æ—¶å€™ä¼šæŠŠä¸Šä¸€æ¬¡çš„å®šæ—¶å™¨æ¸…é™¤ã€é˜²æŠ–ã€‘*/</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">/*æŠŠæ–°è®¾ç½®çš„æ•°æ®ç»™åˆ°refæ•°æ®æº*/</span></span><br><span class="line">          value = newValue</span><br><span class="line">            <span class="comment">/*å†æœ‰ä¾èµ–è¿½è¸ªçš„å‰æä¸‹è§¦å‘å“åº”å¼*/</span></span><br><span class="line">          <span class="title function_">trigger</span>()</span><br><span class="line">        &#125;, delay)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">/*æš´éœ²è¿”å›çš„æ•°æ®åŠ é˜²æŠ–*/</span></span><br><span class="line">      <span class="attr">text</span>: <span class="title function_">useDebouncedRef</span>(<span class="string">&#x27;hello&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shallowRef"><a href="#shallowRef" class="headerlink" title="shallowRef"></a><code>shallowRef</code></h3><p>åˆ›å»ºä¸€ä¸ª ref ï¼Œå°†ä¼šè¿½è¸ªå®ƒçš„ <code>.value</code> æ›´æ”¹æ“ä½œï¼Œä½†æ˜¯å¹¶ä¸ä¼šå¯¹å˜æ›´åçš„ <code>.value</code> åšå“åº”å¼ä»£ç†è½¬æ¢ï¼ˆå³å˜æ›´ä¸ä¼šè°ƒç”¨ <code>reactive</code>ï¼‰</p>
<blockquote>
<p>å‰é¢æˆ‘ä»¬è¯´è¿‡å¦‚æœä¼ å…¥ ref çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†è°ƒç”¨ <code>reactive</code> æ–¹æ³•è¿›è¡Œæ·±å±‚å“åº”è½¬æ¢,é€šè¿‡<code>shallowRef</code>åˆ›å»ºçš„ref,å°†ä¸ä¼šè°ƒç”¨reactiveã€å¯¹è±¡ä¸ä¼šæ˜¯å“åº”å¼çš„ã€‘</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> refOne = <span class="title function_">shallowRef</span>(&#123;&#125;);</span><br><span class="line">refOne.<span class="property">value</span> = &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;;</span><br><span class="line">refOne.<span class="property">id</span> == <span class="number">20</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(refOne.<span class="property">value</span>),refOne.<span class="property">value</span>);<span class="comment">//false  &#123; id: 1 &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="triggerRef-ã€ä¸shallowRefé…åˆã€‘"><a href="#triggerRef-ã€ä¸shallowRefé…åˆã€‘" class="headerlink" title="triggerRef ã€ä¸shallowRefé…åˆã€‘"></a><code>triggerRef</code> ã€ä¸<code>shallowRef</code>é…åˆã€‘</h3><p>æ‰‹åŠ¨æ‰§è¡Œä¸<code>shallowRef</code>ç›¸å…³çš„ä»»ä½•æ•ˆæœ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shallow = <span class="title function_">shallowRef</span>(&#123;</span><br><span class="line">  <span class="attr">greet</span>: <span class="string">&#x27;Hello, world&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è¿è¡Œæ‰“å° &quot;Hello, world&quot; </span></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(shallow.<span class="property">value</span>.<span class="property">greet</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™ä¸ä¼šè§¦å‘æ•ˆæœï¼Œå› ä¸ºrefæ˜¯shallow</span></span><br><span class="line">shallow.<span class="property">value</span>.<span class="property">greet</span> = <span class="string">&#x27;Hello, universe&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å° &quot;Hello, universe&quot;</span></span><br><span class="line"><span class="title function_">triggerRef</span>(shallow)</span><br></pre></td></tr></table></figure>

<h1 id="Composition-API"><a href="#Composition-API" class="headerlink" title="Composition API"></a>Composition API</h1><h2 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h2><p><code>setup</code> å‡½æ•°æ˜¯ä¸€ä¸ªæ–°çš„ç»„ä»¶é€‰é¡¹ã€‚ä½œä¸ºåœ¨ç»„ä»¶å†…ä½¿ç”¨ <strong>Composition API</strong> çš„å…¥å£ç‚¹</p>
<ul>
<li>æ³¨æ„ <code>setup</code> è¿”å›çš„ ref åœ¨æ¨¡æ¿ä¸­ä¼šè‡ªåŠ¨è§£å¼€ï¼Œä¸éœ€è¦å†™ <code>.value</code>ã€<code>setup</code> å†…éƒ¨éœ€è¦<code>.value</code>ã€‘</li>
</ul>
<h3 id="è°ƒç”¨æ—¶æœº"><a href="#è°ƒç”¨æ—¶æœº" class="headerlink" title="è°ƒç”¨æ—¶æœº"></a>è°ƒç”¨æ—¶æœº</h3><ul>
<li>åˆ›å»ºç»„ä»¶å®ä¾‹ï¼Œç„¶ååˆå§‹åŒ– <code>props</code> ï¼Œç´§æ¥ç€å°±è°ƒç”¨<code>setup</code> å‡½æ•°ã€‚ä»ç”Ÿå‘½å‘¨æœŸé’©å­çš„è§†è§’æ¥çœ‹ï¼Œå®ƒä¼šåœ¨ <code>beforeCreate</code> é’©å­ä¹‹å‰è¢«è°ƒç”¨</li>
<li>å¦‚æœ <code>setup</code> è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¯¹è±¡çš„å±æ€§å°†ä¼šè¢«åˆå¹¶åˆ°ç»„ä»¶æ¨¡æ¿çš„æ¸²æŸ“ä¸Šä¸‹æ–‡</li>
</ul>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><ul>
<li><code>props</code> ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°</li>
</ul>
<blockquote>
<p>æ³¨æ„ <code>props</code> å¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œ<code>watchEffect</code> æˆ– <code>watch</code> ä¼šè§‚å¯Ÿå’Œå“åº” <code>props</code> çš„æ›´æ–°</p>
<p><strong>ä¸è¦</strong>è§£æ„ <code>props</code> å¯¹è±¡ï¼Œé‚£æ ·ä¼šä½¿å…¶å¤±å»å“åº”æ€§</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="title class_">String</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">name</span>)</span><br><span class="line">     <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`name is: `</span> + props.<span class="property">name</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ç¬¬äºŒä¸ªå‚æ•°æä¾›äº†ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€ä»åŸæ¥ 2.x ä¸­ <code>this</code> é€‰æ‹©æ€§åœ°æš´éœ²äº†ä¸€äº› propertyï¼ˆattrs/emit/slotsï¼‰ã€‘</p>
<blockquote>
<p><code>attrs</code> å’Œ <code>slots</code> éƒ½æ˜¯å†…éƒ¨ç»„ä»¶å®ä¾‹ä¸Šå¯¹åº”é¡¹çš„ä»£ç†ï¼Œå¯ä»¥ç¡®ä¿åœ¨æ›´æ–°åä»ç„¶æ˜¯æœ€æ–°å€¼ã€‚æ‰€ä»¥å¯ä»¥è§£æ„ï¼Œæ— éœ€æ‹…å¿ƒåé¢è®¿é—®åˆ°è¿‡æœŸçš„å€¼</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆpropsä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Ÿ</p>
<ul>
<li>ç»„ä»¶ä½¿ç”¨ <code>props</code> çš„åœºæ™¯æ›´å¤šï¼Œæœ‰æ—¶å€™ç”šè‡³åªä½¿ç”¨ <code>props</code></li>
<li>å°† <code>props</code> ç‹¬ç«‹å‡ºæ¥ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥è®© TypeScript å¯¹ <code>props</code> å•ç‹¬åšç±»å‹æ¨å¯¼ï¼Œä¸ä¼šå’Œä¸Šä¸‹æ–‡ä¸­çš„å…¶ä»–å±æ€§ç›¸æ··æ·†ã€‚è¿™ä¹Ÿä½¿å¾— <code>setup</code> ã€ <code>render</code> å’Œå…¶ä»–ä½¿ç”¨äº† TSX çš„å‡½æ•°å¼ç»„ä»¶çš„ç­¾åä¿æŒä¸€è‡´</li>
</ul>
<blockquote>
<p><strong><code>this</code> åœ¨ <code>setup()</code> ä¸­ä¸å¯ç”¨</strong>ã€‚ç”±äº <code>setup()</code> åœ¨è§£æ 2.x é€‰é¡¹å‰è¢«è°ƒç”¨ï¼Œ<code>setup()</code> ä¸­çš„ <code>this</code> å°†ä¸ 2.x é€‰é¡¹ä¸­çš„ <code>this</code> å®Œå…¨ä¸åŒã€‚åŒæ—¶åœ¨ <code>setup()</code> å’Œ 2.x é€‰é¡¹ä¸­ä½¿ç”¨ <code>this</code> æ—¶å°†é€ æˆæ··ä¹±</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params">props, &#123; attrs &#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸€ä¸ªå¯èƒ½ä¹‹åå›è°ƒç”¨çš„ç­¾å</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(attrs.<span class="property">foo</span>) <span class="comment">// ä¸€å®šæ˜¯æœ€æ–°çš„å¼•ç”¨ï¼Œæ²¡æœ‰ä¸¢å¤±å“åº”æ€§</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>


<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>è®¸å¯åè®®</span></div><div class="body"><p>æœ¬æ–‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">è¾ƒæ–°æ–‡ç« </div><a href="/2022/04/21/tsconfig-json%E5%85%A8%E8%A7%A3%E6%9E%90/">tsconfig.jsonå…¨è§£æ</a></div><div class="item" id="next"><div class="note">è¾ƒæ—©æ–‡ç« </div><a href="/2022/03/26/%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1-electron-node/">è¿›ç¨‹é€šä¿¡(electron/node)</a></div></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="text"><p>æœ¬ç«™ç”± <a href="/">@anonymity</a> ä½¿ç”¨ <a href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> ä¸»é¢˜åˆ›å»ºã€‚<br>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // æ‡’åŠ è½½ css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // ä» butterfly å’Œ volantis è·å¾—çµæ„Ÿ
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // é»˜è®¤å¼‚æ­¥ï¼Œå¦‚æœéœ€è¦åŒæ­¥ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ {} å³å¯
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.18.5';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5';
  stellar.config = {
    date_suffix: {
      just: 'åˆšåˆš',
      min: 'åˆ†é’Ÿå‰',
      hour: 'å°æ—¶å‰',
      day: 'å¤©å‰',
      month: 'ä¸ªæœˆå‰',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
