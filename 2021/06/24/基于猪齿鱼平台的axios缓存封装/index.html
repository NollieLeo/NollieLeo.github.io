<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£… | ç¿è€å¸ˆçš„åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#00abc0">
    
    
    <meta name="keywords" content="js,axios">
    <meta name="description" content="éœ€æ±‚è¯´æ˜æƒ…å†µ1ï¼šçŒªé½¿é±¼å¹³å°æ˜¯ä¸ªç›¸å¯¹å¤æ‚çš„å¤šè¡¨æ ¼å¤šè¡¨å•æ•°æ®å¤„ç†å¹³å°ï¼Œæœ‰äº›æ¨¡å—çš„æ•°æ®é‡åºå¤§ï¼Œå¹¶ä¸”æœ‰äº›å–œæ¬¢åµŒå…¥åœ¨tabé¡µé¢å½“ä¸­ï¼Œå¦‚æœé¢‘ç¹çš„å»è®¿é—®è¿™äº›é¡µé¢å°±ä¼šé¢‘ç¹çš„è¯·æ±‚ï¼Œå¦‚æœæ•°æ®é‡åºå¤§ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šå»è¯·æ±‚æ•°æ®ï¼Œç­‰å¾…æ—¶é—´å°±å˜é•¿äº†ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªç•Œé¢ï¼š">
<meta property="og:type" content="article">
<meta property="og:title" content="åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…">
<meta property="og:url" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/index.html">
<meta property="og:site_name" content="ç¿è€å¸ˆçš„åšå®¢">
<meta property="og:description" content="éœ€æ±‚è¯´æ˜æƒ…å†µ1ï¼šçŒªé½¿é±¼å¹³å°æ˜¯ä¸ªç›¸å¯¹å¤æ‚çš„å¤šè¡¨æ ¼å¤šè¡¨å•æ•°æ®å¤„ç†å¹³å°ï¼Œæœ‰äº›æ¨¡å—çš„æ•°æ®é‡åºå¤§ï¼Œå¹¶ä¸”æœ‰äº›å–œæ¬¢åµŒå…¥åœ¨tabé¡µé¢å½“ä¸­ï¼Œå¦‚æœé¢‘ç¹çš„å»è®¿é—®è¿™äº›é¡µé¢å°±ä¼šé¢‘ç¹çš„è¯·æ±‚ï¼Œå¦‚æœæ•°æ®é‡åºå¤§ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šå»è¯·æ±‚æ•°æ®ï¼Œç­‰å¾…æ—¶é—´å°±å˜é•¿äº†ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªç•Œé¢ï¼š">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/7.gif">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210624155243688.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/test.gif">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625112724872.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625113745262.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625160815760.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625173040963.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625173136449.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625211727335.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625210606969.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210625210632981.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210626094315248.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210626094721131.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210626101834505.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210626111840112.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210626111852379.png">
<meta property="og:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/image-20210627124622241.png">
<meta property="article:published_time" content="2021-06-24T06:02:44.000Z">
<meta property="article:modified_time" content="2022-02-09T01:45:19.167Z">
<meta property="article:author" content="Mr.Weng">
<meta property="article:tag" content="js">
<meta property="article:tag" content="axios">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/7.gif">
    
        <link rel="alternate" type="application/atom+xml" title="ç¿è€å¸ˆçš„åšå®¢" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Mr.Weng</h5>
          <a href="mailto:736653759@qq.com" title="736653759@qq.com" class="mail">736653759@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/nollieleo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-06-24T06:02:44.000Z" itemprop="datePublished" class="page-time">
  2021-06-24
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/js/">js</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#éœ€æ±‚è¯´æ˜"><span class="post-toc-number">1.</span> <span class="post-toc-text">éœ€æ±‚è¯´æ˜</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æƒ…å†µ1ï¼š"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">æƒ…å†µ1ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æƒ…å†µ2ï¼š"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">æƒ…å†µ2ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æƒ…å†µ3ï¼š"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">æƒ…å†µ3ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#éœ€æ±‚åˆ†æ"><span class="post-toc-number">2.</span> <span class="post-toc-text">éœ€æ±‚åˆ†æ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ç¼“å­˜åˆ†æ"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">ç¼“å­˜åˆ†æ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å®ç°"><span class="post-toc-number">3.</span> <span class="post-toc-text">å®ç°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#axiosçš„å®ä¾‹åŒ–"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">axiosçš„å®ä¾‹åŒ–</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ ‡è¯†çš„å®ç°"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">æ ‡è¯†çš„å®ç°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ç¼“å­˜å®ç°"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">ç¼“å­˜å®ç°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#å­˜å‚¨æ•°æ®"><span class="post-toc-number">3.3.1.</span> <span class="post-toc-text">å­˜å‚¨æ•°æ®</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#è¯·æ±‚æ‹¦æˆªå™¨å®ç°"><span class="post-toc-number">3.3.2.</span> <span class="post-toc-text">è¯·æ±‚æ‹¦æˆªå™¨å®ç°</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#å“åº”æ‹¦æˆªå™¨çš„å®ç°"><span class="post-toc-number">3.3.3.</span> <span class="post-toc-text">å“åº”æ‹¦æˆªå™¨çš„å®ç°</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚-1"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ‹¦æˆªå™¨çš„å®ç°"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">æ‹¦æˆªå™¨çš„å®ç°</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#è·¯ç”±å®ˆå«çš„å®ç°"><span class="post-toc-number">3.4.2.</span> <span class="post-toc-text">è·¯ç”±å®ˆå«çš„å®ç°</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é—ç•™é—®é¢˜"><span class="post-toc-number">4.</span> <span class="post-toc-text">é—ç•™é—®é¢˜</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#åŸå› ä¸€ï¼š"><span class="post-toc-number">4.1.1.</span> <span class="post-toc-text">åŸå› ä¸€ï¼š</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#åŸå› äºŒ"><span class="post-toc-number">4.1.2.</span> <span class="post-toc-text">åŸå› äºŒ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#åŸå› ä¸‰"><span class="post-toc-number">4.1.3.</span> <span class="post-toc-text">åŸå› ä¸‰</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#éš¾ç‚¹è§£å†³"><span class="post-toc-number">5.</span> <span class="post-toc-text">éš¾ç‚¹è§£å†³</span></a></li></ol>
        </nav>
    </aside>


<article id="post-åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">åŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-06-24 14:02:44" datetime="2021-06-24T06:02:44.000Z"  itemprop="datePublished">2021-06-24</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/js/">js</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="éœ€æ±‚è¯´æ˜"><a href="#éœ€æ±‚è¯´æ˜" class="headerlink" title="éœ€æ±‚è¯´æ˜"></a>éœ€æ±‚è¯´æ˜</h2><h3 id="æƒ…å†µ1ï¼š"><a href="#æƒ…å†µ1ï¼š" class="headerlink" title="æƒ…å†µ1ï¼š"></a>æƒ…å†µ1ï¼š</h3><p>çŒªé½¿é±¼å¹³å°æ˜¯ä¸ªç›¸å¯¹å¤æ‚çš„å¤šè¡¨æ ¼å¤šè¡¨å•æ•°æ®å¤„ç†å¹³å°ï¼Œæœ‰äº›æ¨¡å—çš„æ•°æ®é‡åºå¤§ï¼Œå¹¶ä¸”æœ‰äº›å–œæ¬¢åµŒå…¥åœ¨tabé¡µé¢å½“ä¸­ï¼Œå¦‚æœé¢‘ç¹çš„å»è®¿é—®è¿™äº›é¡µé¢å°±ä¼šé¢‘ç¹çš„è¯·æ±‚ï¼Œå¦‚æœæ•°æ®é‡åºå¤§ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šå»è¯·æ±‚æ•°æ®ï¼Œç­‰å¾…æ—¶é—´å°±å˜é•¿äº†ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªç•Œé¢ï¼š</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="7.gif" alt="7" title>
                </div>
                <div class="image-caption">7</div>
            </figure>

<p>è¿™ä¸ªé¡µé¢ç›¸å½“äºæ˜¯å†å²çš„æ‰§è¡Œè®°å½•ï¼Œå› ä¸ºæ•°æ®é‡åºå¤§ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¡µé¢è¯·æ±‚è¿‡åå“åº”é€Ÿåº¦è¾ƒæ…¢ï¼Œå‡è®¾æˆ‘åœ¨çŸ­æ—¶é—´å†…åˆ‡åˆ°åˆ«çš„è®°å½•åˆåˆ‡å›æ¥è¦çœ‹ï¼Œé‚£è¿˜å¾—é‡æ–°å†å»è¯·æ±‚è¿™1000å¤šæ¡çš„æ•°æ®ï¼Œè¿™ä¸ªæ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œç”¨æˆ·ç­‰å¾…æ—¶é—´å°±å˜é•¿äº†</p>
<h3 id="æƒ…å†µ2ï¼š"><a href="#æƒ…å†µ2ï¼š" class="headerlink" title="æƒ…å†µ2ï¼š"></a>æƒ…å†µ2ï¼š</h3><p>åœ¨ä¸€ä¸ªé¡µé¢æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæˆ–è€…åœ¨æŸäº›ä¸æ­£å½“çš„äº¤äº’æ“ä½œä¸­ï¼Œç”¨æˆ·å¯èƒ½é¢‘ç¹çš„å‘åå°å»å‘é€åŒä¸€ä¸ªè¯·æ±‚ï¼ˆå‚æ•°urlç­‰å¾…éƒ½ä¸€æ ·ï¼‰ï¼Œæˆ–åˆæ˜¯å†æ¸²æŸ“é¡µé¢çš„ä¸€ç¬é—´è§¦å‘äº†å¤šæ¬¡åŒä¸€è¯·æ±‚ï¼Œè¿™æ ·å°±å¾ˆæµªè´¹å¸¦å®½ï¼Œå¤šæ¬¡è¯·æ±‚å‰ç«¯è¿˜éœ€è¦è¿›è¡Œå¤šæ¬¡çš„å“åº”å¤„ç†ï¼Œä¾‹å¦‚ä»¥ä¸‹æƒ…å†µ</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210624155243688.png" alt="image-20210624155243688" title>
                </div>
                <div class="image-caption">image-20210624155243688</div>
            </figure>

<p>åœ¨æ¸²æŸ“é¡µé¢æ—¶ï¼ŒåŒæ—¶å‘é€äº†å¤šä¸ªç›¸åŒè¯·æ±‚ï¼Œå¤§å¤šæ—¶å€™æ˜¯é¡µé¢é€»è¾‘å¤„ç†çš„æœ‰é—®é¢˜ï¼Œå¤šæ¬¡å‘åå°è·å–æ•°æ®äº†ï¼Œæˆ–è€…æ˜¯æˆ‘é¢‘ç¹çš„å»ç‚¹å‡»ä¸€ä¸ªæ²¡æœ‰åšé˜²æŠ–çš„æŒ‰é’®æˆ–è€…æ²¡æœ‰èŠ‚æµçš„ä¸€äº›é¢‘ç¹è¯·æ±‚</p>
<h3 id="æƒ…å†µ3ï¼š"><a href="#æƒ…å†µ3ï¼š" class="headerlink" title="æƒ…å†µ3ï¼š"></a>æƒ…å†µ3ï¼š</h3><p>å‡è®¾æˆ‘é”™è¯¯çš„ç‚¹å‡»äº†ä¸€ä¸ªèœå•çš„åŒæ—¶åˆå»åˆ‡åˆ°äº†å¦å¤–ä¸€ä¸ªèœå•ï¼Œè¿™æ—¶å€™è™½ç„¶è¯´å·²ç»åˆ‡æ¢åˆ°äº†æƒ³è¦çš„èœå•è·¯ç”±ä¸‹å¯¹åº”çš„ç•Œé¢ï¼Œä½†æ˜¯ç”±äºä½ é”™è¯¯çš„æ“ä½œï¼Œè™½ç„¶ä¸Šä¸ªé¡µé¢åœ¨åˆ‡è·¯ç”±ç¬é—´è¢«é”€æ¯ï¼Œä½†æ˜¯åˆå§‹åŒ–é¡µé¢çš„ä¸€äº›è·å–åå°æ•°æ®çš„è¯·æ±‚å·²ç»å‘å‡ºå»äº†ï¼Œä½ è®¿é—®çš„å½“å‰é¡µé¢æ˜¯ä¸éœ€è¦è¿™äº›è¯·æ±‚çš„ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="test.gif" alt="test" title>
                </div>
                <div class="image-caption">test</div>
            </figure>

<p>è¿™ä¸ªä¾‹å­å°±æ˜¯ï¼Œæˆ‘å…ˆç‚¹å‡»äº†ä»£ç ç®¡ç†çš„èœå•ï¼Œä»£ç ç®¡ç†æ¨¡å—ç»„ä»¶ç¬é—´è¢«åŠ è½½å‡ºæ¥ï¼Œå¹¶ä¸”å‘é€é¡µé¢è¯·æ±‚ï¼Œè¿™æ—¶å€™ä¸€ç¬é—´åˆ‡æ¢åˆ°åº”ç”¨æµæ°´çº¿çš„èœå•ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¼šçœ‹è§ï¼Œä»£ç ç®¡ç†æ¨¡å—çš„è¯·æ±‚å¾ˆå¤šæ²¡å¿…è¦çš„éƒ½å‘é€å‡ºå»äº†ï¼Œè¿™äº›è¯·æ±‚å¹¶ä¸æ˜¯æˆ‘ä»¬åº”ç”¨æµæ°´çº¿æ¨¡å—éœ€è¦ç”¨çš„åˆ°çš„ã€‚</p>
<p>å¦‚æœä¸Šä¸ªé¡µé¢çš„è¯·æ±‚å¾ˆæ…¢æˆ–è€…å¾ˆå¤šæƒ…å†µä¸‹ï¼Œéƒ½ä¼šå ç”¨ä¸å¿…è¦çš„èµ„æºä»¥åŠå‰ç«¯å¤„ç†æ—¶é—´ï¼Œå ç”¨èµ„æºã€‚</p>
<h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><ol>
<li>é’ˆå¯¹æƒ…å†µ1, æˆ‘ä»¬å¯ä»¥åšç¼“å­˜, ç±»ä¼¼äºDataSetçš„lookupï¼Œä½†åˆä¸å®Œå…¨ç±»ä¼¼ã€‚ä¹Ÿå¯ä»¥åšç±»ä¼¼tabçš„æ•°æ®ç¼“å­˜å¤„ç†ï¼Œ ä½†æ˜¯å¦‚æœé¡µé¢å¤šèµ·æ¥ï¼Œæˆ‘ä»¬å°±éœ€è¦å¤šæ¬¡åˆ†åˆ«å¯¹æ•°æ®è¿›è¡Œç¼“å­˜å¤„ç†ã€‚</li>
<li>é’ˆå¯¹ç¬¬äºŒç§çš„æƒ…å†µï¼Œå¯ä»¥å°†é‡å¤çš„è¯·æ±‚ç»™å–æ¶ˆæ‰ï¼Œæˆ–è€…è¯´åœ¨è¿™ä¸€ç¬é—´å‘é€çš„å¤šæ¬¡ç›¸åŒè¯·æ±‚éƒ½å…±ç”¨ç¬¬ä¸€æ¬¡å‘é€çš„é‚£ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ã€‚ä¸€äº›æŒ‰é’®æˆ–è€…é¢‘ç¹è¯·æ±‚çš„æ“ä½œåšèŠ‚æµå’Œé˜²æŠ–å¤„ç†ï¼Œè¿™ä¸ªå°±ä¸å†è¿™æ¬¡çš„è®¨è®ºèŒƒå›´å†…äº†</li>
<li>ç¬¬ä¸‰ç§æƒ…å†µåœ¨åˆ‡æ¢è·¯ç”±çš„æ—¶å€™å¯ä»¥æƒ³åŠæ³•æŠŠä¸Šä¸ªé¡µé¢è¿˜åœ¨pendingä¸­çš„è¯·æ±‚ç»™å–æ¶ˆæ‰</li>
<li>çŒªé½¿é±¼å¹³å°ç”¨çš„æ˜¯axios + DataSetæ¥è¿›è¡Œå‰åç«¯æ•°æ®äº¤äº’ä»¥åŠè¯·æ±‚å¤„ç†çš„ï¼Œæ‰€ä»¥åŸºäºä»–ä»¬è¦å¦‚ä½•å®Œç¾å®ç°å‘¢ï¼Ÿ</li>
</ol>
<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼š</strong>æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªï¼Œèƒ½å¤Ÿå®ç°å–æ¶ˆï¼Œåˆèƒ½å®ç°ç¼“å­˜çš„ï¼Œé‡ç‚¹æ˜¯å®ç°ç›¸åŒè¯·æ±‚çš„çŠ¶æ€æ•°æ®çš„å…¬ç”¨ä»¥åŠä¸å½±å“datasetçš„ä½¿ç”¨çš„ä¸œè¥¿</p>
<p>å¯ä»¥æƒ³åˆ°çš„æ˜¯ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯è¦å¯¹axiosçš„æ‹¦æˆªå™¨æˆ–è€…ä¸€äº›ç‰¹æ®Šå±æ€§ä¾‹å¦‚axiosçš„é€‚é…å™¨ï¼Œåšå¤„ç†ã€‚</p>
<h3 id="ç¼“å­˜åˆ†æ"><a href="#ç¼“å­˜åˆ†æ" class="headerlink" title="ç¼“å­˜åˆ†æ"></a>ç¼“å­˜åˆ†æ</h3><p>å‚è€ƒçŒªé½¿é±¼lookupçš„ç¼“å­˜åŸç†ï¼Œä»¥ä¸‹æ”¾å‡ºlookupç¼“å­˜çš„éƒ¨åˆ†æºç ï¼›</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625112724872.png" alt="image-20210625112724872" title>
                </div>
                <div class="image-caption">image-20210625112724872</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625113745262.png" alt="image-20210625113745262" title>
                </div>
                <div class="image-caption">image-20210625113745262</div>
            </figure>

<p>lookupé€šè¿‡æ ‡è¯†ç¡®å®šæ˜¯å¦ç¼“å­˜ï¼Œä¹‹åå°†é€‚é…å™¨è¿”å›çš„æœŸçº¦ç›´æ¥ç»™ä¸€ä¸ªæ–°å¾—æœŸçº¦ï¼Œä¹‹åå­˜å‚¨è¿™ä¸ªæ–°å¾—æœŸçº¦ï¼Œåœ¨ä¸‹æ¬¡å‘é€ç›¸åŒè¯·æ±‚æ—¶å€™ç›´æ¥å°†è¿™ä¸ªæœŸçº¦æŠ›ç»™å®ƒï¼Œä»è€Œå®ç°è¯·æ±‚çš„å¤ç”¨</p>
<p><strong>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½axios çš„ adpaterçš„åŸç†ï¼š</strong></p>
<p>æºç æ˜¯è¿™æ ·çš„</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625160815760.png" alt="image-20210625160815760" title>
                </div>
                <div class="image-caption">image-20210625160815760</div>
            </figure>

<p>å¯ä»¥çŸ¥é“çš„æ˜¯ï¼Œaxios çš„ transformRequestä»¥åŠä»–çš„å„ä¸ªè¯·æ±‚æ‹¦æˆªå™¨æ˜¯åœ¨returnè¿™ä¸ªæœŸçº¦ä¹‹å‰å‘ç”Ÿçš„ï¼Œä¹‹åè¯·æ±‚å®Œæˆï¼Œadapterå°†è¯·æ±‚åçš„ç»“æœä¼ é€’ç»™æœŸçº¦ï¼Œä¹‹åæœŸçº¦è½å®šï¼Œåé¢æ‰è§¦å‘å“åº”æ•°æ®è½¬æ¢ï¼ˆtransformReponseï¼‰ä»¥åŠå“åº”æ‹¦æˆªå™¨ï¼ˆè¿™ä¸ªé¡ºåºéå¸¸çš„é‡è¦ï¼‰ã€‚</p>
<p>æ—¢ç„¶è¦ç¼“å­˜ï¼Œä¸€å®šè¦æŠŠç¬¬ä¸€æ¬¡è½å®šçš„è¯·æ±‚æœŸçº¦ï¼Œæƒ³åŠæ³•ï¼ˆåŒ…å«äº†å“åº”ç æ•°æ®ç­‰ç­‰ç­‰ï¼‰å­˜å‚¨èµ·æ¥ï¼Œéœ€è¦ç”¨åˆ°çš„æ—¶å€™æ‰å»ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šçš„æ˜¯æˆ‘ä»¬ç¼“å­˜éœ€è¦å¯¹adapterè¿›è¡Œæ“ä½œï¼Œå¹¶ä¸”åœ¨å“åº”å’Œè¯·æ±‚çš„æ‹¦æˆªå™¨ä¸­åšæ ‡è¯†ç­‰ç­‰æ“ä½œ</p>
<h3 id="å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†"><a href="#å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†" class="headerlink" title="å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†"></a>å¤šæ¬¡ç›¸åŒè¯·æ±‚å¤„ç†</h3><p>ä¸€å¼€å§‹æˆ‘æƒ³ç”¨XMLHttpRequestçš„abortä¹Ÿå°±æ˜¯axiosçš„CancelTokenï¼ˆaxioså¯¹abortè¿›è¡Œäº†å°è£…ï¼‰å»å°†é¡µé¢æ­£åœ¨æ¸²æŸ“çš„æ—¶å€™ä¸€ä¸ªä¸ªé‡å¤çš„è¯·æ±‚cancelæ‰ï¼Œä½†æ˜¯è¿™æ ·æœ‰å¤šç§å¼Šç«¯ï¼Œç•™åˆ°æœ€åä¸€ç‚¹è®²ã€‚</p>
<p>å¤šæ¬¡ç›¸åŒè¯·æ±‚æ˜¯ä¸€ç¬é—´çš„äº‹æƒ…ï¼Œè¦åœ¨è¿™ä¸€ç¬é—´å¤ç”¨è¯·æ±‚å¿…é¡»ç”¨åˆ°ä¸Šé¢ç¼“å­˜æ‰€è¯´çš„å­˜å‚¨æœŸçº¦ã€‚</p>
<p>ä¸€ç¬é—´å’±ä»¬å°±å¯ä»¥å®šä¸€ä¸ªé»˜è®¤æ—¶é—´æˆ³ï¼Œä¾‹å¦‚1000msï¼Œè¿™ä¸ªæ—¶é—´æˆ³è¡¨ç¤ºçš„æ˜¯ï¼Œåœ¨è¿™1000msä¸­è¿›æ¥çš„è¯·æ±‚éƒ½å…±ç”¨ä¸€ä¸ªadapterçš„æœŸçº¦ï¼Œè¿™æ ·å®šä¹‰ä¸€ä¸ªé»˜è®¤æ—¶é—´æˆ³ï¼Œå°±å¯ä»¥åšåˆ°ç±»ä¼¼å–æ¶ˆé‡å¤è¯·æ±‚çš„ä½œç”¨ï¼ˆå®é™…ä¸Šæ˜¯ç”¨äº†ç¼“å­˜ï¼‰ã€‚</p>
<p>å½“ç„¶æ—¢ç„¶åŠ äº†ç¼“å­˜ï¼ŒåˆåŠ äº†æ—¶é—´æˆ³ï¼Œçµæ´»åº”ç”¨ä¸€ä¸‹å°±å¯ä»¥å®ç°ä¸€ä¸ªï¼Œåœ¨å¯¹åº”æ—¶é—´å†…ä¸å•å•æ˜¯1000msï¼Œæˆ‘å‘çš„ç›¸åŒè¯·æ±‚éƒ½å…±ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´æˆ³ç›´æ¥å®šä¹‰åœ¨axiosé»˜è®¤å±æ€§ä¸Šæˆ–è€…axiosåˆ›å»ºå‡ºæ¥çš„å®ä¾‹ä¸Šé¢ï¼Œå®šä¹‰é»˜è®¤å€¼1000msï¼Œä¹‹åå¦‚æœæƒ³è¦ç¼“å­˜æ—¶é—´é•¿ä¸€ç‚¹çš„è¯ç›´æ¥åœ¨datasetçš„transportå¯¹åº”çš„æ–¹æ³•é…ç½®é¡¹ä¸‹é¢æˆ–è€…æ˜¯axioså®ä¾‹ä¸Šæ·»åŠ æ—¶é—´æˆ³ï¼Œç”¨æ¥è¦†ç›–é»˜è®¤çš„æ—¶é—´æˆ³ï¼Œå› æ­¤å¯ä»¥å®ç°é•¿æ•ˆç¼“å­˜ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625173040963.png" alt="image-20210625173040963" title>
                </div>
                <div class="image-caption">image-20210625173040963</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625173136449.png" alt="image-20210625173136449" title>
                </div>
                <div class="image-caption">image-20210625173136449</div>
            </figure>



<h3 id="åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚"><a href="#åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚" class="headerlink" title="åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚"></a>åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚</h3><p>è¿™é‡Œå¿…é¡»ç”¨åˆ°axiosçš„CancelTokenã€‚ä¸Šé¢è¯´åˆ°CancelTokençš„å…¶å®å°±æ˜¯å¯¹<code>XMLhttpRequest</code>çš„abortæ–¹æ³•è¿›è¡Œå°è£…ï¼Œ <code>XMLHttpRequest</code> å¯¹è±¡æ˜¯æˆ‘ä»¬å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„æ ¹æœ¬ï¼Œåœ¨å®ƒåº•ä¸‹æœ‰æ€ä¹ˆä¸€ä¸ªæ–¹æ³• <code>.abort()</code>ï¼Œå°±æ˜¯ä¸­æ–­ä¸€ä¸ªå·²è¢«å‘å‡ºçš„è¯·æ±‚ã€‚ </p>
<p><img src="image-20210625211727335.png" alt="image-20210625211727335"></p>
<p> ç®€å•ç†è§£å°±æ˜¯é€šè¿‡ <code>new axios.CancelToken()</code>ç»™æ¯ä¸ªè¯·æ±‚å¸¦ä¸Šä¸€ä¸ªä¸“å±çš„CancelTokenï¼Œä¹‹åä¼šæ¥æ”¶åˆ°ä¸€ä¸ª<code>cancel()</code> å–æ¶ˆæ–¹æ³•ï¼Œç”¨äºåç»­çš„å–æ¶ˆåŠ¨ä½œã€‚ </p>
<p>æ‰€ä»¥ï¼Œæ¯æ¬¡è¯·æ±‚è¿›æ¥çš„æ—¶å€™å»è·å–æœ¬æ¬¡è¯·æ±‚çš„CancelTokenï¼Œä¹‹åå°†å…¶å­˜èµ·æ¥ï¼ˆè¿™é‡Œå‡è®¾ç”¨CancelQueueçš„ä¸€ä¸ªMapæ•°æ®ç±»å‹ï¼ˆ<code>Object.prototype.toString.call(CancelQueue) = &#39;[object Map]&#39;</code>ï¼‰ï¼‰ï¼Œä¹‹åå‡å¦‚è¿™ä¸ªè¯·æ±‚è½å®šäº†ï¼Œå°±å°†è¿™ä¸ªå­˜å‚¨CancelTokençš„è¯·æ±‚æ ‡è¯†åˆ é™¤ã€‚</p>
<p>å¦‚æœè¿™æ—¶å€™åˆ‡æ¢è·¯ç”±äº†ï¼Œæˆ‘ä»¬å°±å»CancelQueueä¸­ï¼Œéå†ä¸€éæ‰€æœ‰çš„è¯·æ±‚æ ‡è¯†ï¼ˆå› ä¸ºè¿™æ—¶å€™å†é˜Ÿåˆ—é‡Œå¤´çš„è‚¯å®šæ˜¯è¿˜åœ¨pendingçš„è¯·æ±‚ï¼‰ï¼Œè°ƒç”¨å…¶å­˜å‚¨çš„CancelTokenè°ƒç”¨cancelæ–¹æ³•è¿›è¡Œè¯·æ±‚å–æ¶ˆï¼Œå¹¶åˆ é™¤æ ‡è¯†ã€‚</p>
<pre><code class="js">// 1. è·å– axios CancelToken
const { CancelToken } = axios;

// 2. è·å–å½“å‰è¯·æ±‚çš„sourceï¼Œå¹¶ä¸”å°†å…¶cancelæ–¹æ³•å­˜å‚¨èµ·æ¥
const source = CancelToken.source();

// 3. ä¹‹åè°ƒç”¨è¿™ä¸ªcancelæ–¹æ³•
source.cancel();
</code></pre>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="axiosçš„å®ä¾‹åŒ–"><a href="#axiosçš„å®ä¾‹åŒ–" class="headerlink" title="axiosçš„å®ä¾‹åŒ–"></a>axiosçš„å®ä¾‹åŒ–</h3><p>é¦–å…ˆå®ä¾‹åŒ–axios(è¿™æ˜¯æˆ‘ä»¬å…¨å±€å°è£…çš„axios)ï¼Œåœ¨å…¶ä¸­åŠ å…¥ç¼“å­˜æ ‡è¯†ï¼Œæ ‡è¯†å¼€å¯ç¼“å­˜ï¼ˆé‡å¤è¯·æ±‚å…±ç”¨ï¼‰</p>
<pre><code class="js">const instance:AxiosStatic = axios.create({
  timeout: 30000,
  baseURL: API_HOST,
});

// è¿™é‡Œé…ç½®ä¸€ä¸ªç¼“å­˜è¯·æ±‚å¾—æ ‡è¯†
instance.defaults.enabledCancelCache = true;</code></pre>
<h3 id="æ ‡è¯†çš„å®ç°"><a href="#æ ‡è¯†çš„å®ç°" class="headerlink" title="æ ‡è¯†çš„å®ç°"></a>æ ‡è¯†çš„å®ç°</h3><p>å¯¹äºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ ‡è¯†ï¼Œæ ‡è¯†å”¯ä¸€ï¼Œæ ‡è¯†æ˜¯é€šè¿‡æ¯ä¸€ä¸ªè¯·æ±‚çš„<code>url</code>, <code>params</code>, <code>method</code>, ä»¥åŠ <code>data</code>å»ºç«‹æ ‡è¯†ï¼Œåªè¦é€šè¿‡è¿™4è€…å»ºç«‹çš„æ ‡è¯†ç›¸åŒï¼Œé‚£æˆ‘ä»¬å°±èƒ½ç¡®å®šæŸäº›è¯·æ±‚æ˜¯ç›¸åŒçš„ï¼Œ</p>
<p>å¦‚ä¸‹<code>getMark</code>æ˜¯å»ºç«‹ä¸»æ ‡è¯†ï¼Œ<code>getDataMark</code>æ˜¯å¯¹å“åº”ä½“å†…çš„dataçš„æ ‡è¯†</p>
<p>paramsè¦è¿›è¡Œå‚æ•°æ‹¼æ¥ï¼Œç°åœ¨ä¸»æµåŸºæœ¬åœ¨ç”¨<code>application/json</code>å½¢å¼ï¼ŒAxiosé»˜è®¤ä»¥è¿™ç§å½¢å¼å·¥ä½œï¼Œæˆ‘ä»¬ç»™åç«¯æ¥å£ä¼ é€’å‚æ•°ä¹Ÿç®€å• ï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦ Content-Typeå¿…é¡»ä»¥application/x-www-form-urlencodedå½¢å¼ ï¼Œä»¥JSONæ ¼å¼åå°æ˜¯æ”¶ä¸åˆ°çš„ï¼Œè€Œè¿™æ—¶å€™å°±è¦è¿›è¡Œåºåˆ—åŒ–å¤„ç†ï¼ˆå…ˆå‰æ˜¯æœ‰å‰è¾ˆåœ¨è¿™é‡Œåšäº†å¤„ç†çš„ï¼‰ï¼Œä½†æ˜¯è¿™é‡Œä¸å¤šè¯´å‚æ•°åºåˆ—åŒ–</p>
<pre><code class="js">import { get } from &#39;lodash&#39;;
import { AxiosRequestConfig } from &#39;axios&#39;;
import JSONbig from &#39;json-bigint&#39;;
import paramsSerializer from &#39;./paramsSerializer&#39;;

// å•ç‹¬å¤„ç†dataï¼Œresponseé‡Œé¢è¿”å›çš„config.dataæ˜¯ä¸ªå­—ç¬¦ä¸²å¯¹è±¡
function getDataMark(data:any) {
  let stringifyData = data;
  if (typeof stringifyData === &#39;string&#39;) {
    stringifyData = JSONbig.parse(stringifyData);
  }
  return stringifyData;
}

// åŒºåˆ«è¯·æ±‚çš„å”¯ä¸€æ ‡è¯†ï¼Œè¿™é‡Œç”¨æ–¹æ³•å+è¯·æ±‚è·¯å¾„
// å¦‚æœä¸€ä¸ªé¡¹ç›®é‡Œæœ‰å¤šä¸ªä¸åŒbaseURLçš„è¯·æ±‚ + å‚æ•°
export default function getMark(config:AxiosRequestConfig) {
  const getKey = (key:string) =&gt; get(config, key);

  // paramsæ ‡è¯†å¤„ç†ï¼Œå°†å…¶å¤„ç†æˆ?key=value&amp;key2=valueçš„å½¢å¼
  const tempQueryString = (getKey(&#39;paramsSerializer&#39;) ?? paramsSerializer)(getKey(&#39;params&#39;));

  // dataæ ‡è¯†å¤„ç†
  const dataMark = JSONbig.stringify(getDataMark(getKey(&#39;data&#39;)));

  // baseæ ‡è¯†
  const requestMark = [
    config?.method?.toLowerCase() || &#39;unknownMethod&#39;,
    config?.url,
  ];

  getKey(&#39;params&#39;) &amp;&amp; requestMark.push(tempQueryString);
  getKey(&#39;data&#39;) &amp;&amp; requestMark.push(dataMark);
  return requestMark.join(&#39;&amp;&#39;);
}</code></pre>
<p>æœ€ç»ˆçš„æ‹¼æ¥å½¢å¼æ˜¯ <code>method &amp; url &amp; params &amp; data</code>çš„å½¢å¼ï¼Œ</p>
<p>ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªè¯·æ±‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625210606969.png" alt="image-20210625210606969" title>
                </div>
                <div class="image-caption">image-20210625210606969</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210625210632981.png" alt="image-20210625210632981" title>
                </div>
                <div class="image-caption">image-20210625210632981</div>
            </figure>

<p>æœ€ç»ˆæ‹¼æ¥å‡ºæ¥çš„æ˜¯</p>
<p><code>post&amp;http://172.23.16.92:30094/iam/choerodon/v1/permissions/menus/check-permissions&amp;tenantId=2&amp;[&quot;choerodon.code.organization.project.ps.create&quot;]</code></p>
<h3 id="ç¼“å­˜å®ç°"><a href="#ç¼“å­˜å®ç°" class="headerlink" title="ç¼“å­˜å®ç°"></a>ç¼“å­˜å®ç°</h3><p>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨æ‹¦æˆªå™¨çš„å½¢å¼å»æ·»åŠ ç¼“å­˜é€»è¾‘ï¼Œä»¥ä¸‹æ˜¯æ·»åŠ äº†è¯·æ±‚æ‹¦æˆªå™¨</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210626094315248.png" alt="image-20210626094315248" title>
                </div>
                <div class="image-caption">image-20210626094315248</div>
            </figure>

<p>ä¸‹é¢æ ‡çº¢çš„æ˜¯æ·»åŠ å“åº”æ‹¦æˆªå™¨</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210626094721131.png" alt="image-20210626094721131" title>
                </div>
                <div class="image-caption">image-20210626094721131</div>
            </figure>

<p>è‡³äºè¿™é‡Œæ‹¦æˆªå™¨çš„é¡ºåºä¸ºä»€ä¹ˆæ˜¯è¿™æ ·çš„ï¼Œåç»­å†è¯´</p>
<p>å…¶æ¬¡ï¼Œæˆ‘ä»¬è¦æ˜ç™½è¯·æ±‚çš„å‡ ç§æƒ…å†µ</p>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªAè¯·æ±‚è¿›æ¥äº†</p>
<ol>
<li>è¿˜åœ¨pendingçš„æ—¶å€™ï¼Œåœ¨é»˜è®¤æ—¶é—´æˆ³å†…ï¼ˆ1000msï¼‰åˆè¿›æ¥äº†ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„Aè¯·æ±‚ï¼ˆé‡å¤äº†,å…±ç”¨çŠ¶æ€ï¼‰</li>
<li>Aè¯·æ±‚å·²ç»è½å®šäº†<strong>æˆåŠŸäº†</strong>ï¼Œåœ¨å®šä¹‰çš„æ—¶é—´æˆ³èŒƒå›´å†…åˆè¿›æ¥äº†å¤šä¸ªä¸€æ¨¡ä¸€æ ·çš„è¯·æ±‚ï¼ˆç¼“å­˜ï¼‰</li>
<li>Aè¯·æ±‚è½å®š<strong>å¤±è´¥äº†</strong>ï¼Œåœ¨å®šä¹‰çš„æ—¶é—´æˆ³èŒƒå›´å†…åˆè¿›æ¥äº†å¤šä¸ªä¸€æ¨¡ä¸€æ ·çš„è¯·æ±‚ï¼ˆä¸ç¼“å­˜ï¼‰</li>
</ol>
<p>æœ€åæ˜ç¡®éœ€è¦å­˜å‚¨åœ¨ç¼“å­˜å®ä¾‹ä¸­çš„æ•°æ®æ ¼å¼</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210626101834505.png" alt="image-20210626101834505" title>
                </div>
                <div class="image-caption">image-20210626101834505</div>
            </figure>

<h4 id="å­˜å‚¨æ•°æ®"><a href="#å­˜å‚¨æ•°æ®" class="headerlink" title="å­˜å‚¨æ•°æ®"></a>å­˜å‚¨æ•°æ®</h4><p>æˆ‘ä»¬éœ€è¦ä»¥ä¸€ç§é”®å€¼å¯¹çš„å½¢å¼å»å­˜å‚¨ï¼Œå¯é€‰é¡¹å°±å±Objectæˆ–è€…Mapã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬éœ€è¦é¢‘ç¹çš„å¯¹ç¼“å­˜çš„æ•°æ®è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ’å…¥ï¼Œèµ‹å€¼ï¼Œåˆ é™¤æ“ä½œç­‰ç­‰ã€‚</p>
<p>åœ¨å°æ•°é‡æ•°æ®æƒ…å†µä¸‹Objectçš„æŸ¥æ‰¾æ•°æ®ç›¸å¯¹Mapæ¥çš„å¿«ï¼Œä½†æ˜¯æ¶‰åŠæ›´å¤šæ’å…¥çš„å’Œåˆ é™¤çš„æƒ…å†µä¸‹éƒ½æ˜¯Mapæ€§èƒ½æ¥çš„ä¼˜åŠ¿ï¼Œå¹¶ä¸”ç›¸åŒå†…å­˜ä¸‹Mapèƒ½å¤Ÿå­˜å‚¨æ›´å¤šçš„é”®å€¼å¯¹ï¼Œè¿™é‡Œæ˜¾ç„¶å­˜åœ¨åºå¤§æ•°æ®çš„æƒ…å†µ</p>
<p>äºæ˜¯è¿™é‡Œå°è£…ä¸€ä¸ª<code>AxiosCache</code>ç¼“å­˜ç±»ï¼Œç„¶åå†™ä¸€äº›ç§æœ‰æ–¹æ³•åœ¨é‡Œå¤´</p>
<pre><code class="js">class AxiosCache {
  constructor() {
    super();
    this.cacheData = new Map();
  }

  get size() {
    return this.cacheData.size;
  }

  get(key) {
    return this.cacheData.get(key);
  }

  delete(key) {
    this.cacheData.delete(key);
  }

  has(key) {
    return this.cacheData.has(key);
  }

  set(key, value) {
    this.cacheData.set(key, value);
  }

  isEmpty() {
    return !!this.cacheData.size;
  }

  clear() {
    this.cacheData = new Map();
  }
}
const axiosCache = new AxiosCache();</code></pre>
<h4 id="è¯·æ±‚æ‹¦æˆªå™¨å®ç°"><a href="#è¯·æ±‚æ‹¦æˆªå™¨å®ç°" class="headerlink" title="è¯·æ±‚æ‹¦æˆªå™¨å®ç°"></a>è¯·æ±‚æ‹¦æˆªå™¨å®ç°</h4><ol>
<li><p>å½“Aè¯·æ±‚è¿›æ¥æ—¶å€™å‘ç°å…ˆå‰å¹¶æ²¡æœ‰åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­åšè¿‡æ ‡è¯†ï¼Œä¹Ÿå°±æ˜¯è¯´æ ‡è¯†é‡Œå¤´ä¸å­˜åœ¨ä»¥ä¸Šçš„é‚£äº›å­—æ®µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å°†Aè¯·æ±‚åšä¸ªæ ‡è¯†ï¼Œå¹¶ä¸”è®¾ç½®å®ƒçš„isPendingï¼ˆæ­£åœ¨è¯·æ±‚ï¼‰ä¸º<code>true</code></p>
<pre><code class="ts">axiosCache.set(cancelCacheKey, {
    isPending: true,
});</code></pre>
</li>
<li><p>å½“Aè¯·æ±‚å·²ç»åšè¿‡æ ‡è¯†çš„æ—¶å€™ï¼Œè¿™æ—¶å€™åˆè¿›æ¥ä¸€ä¸ªA1è¯·æ±‚</p>
<p>å€˜è‹¥ç¬¬ä¸€æ¬¡åšè¿‡æ ‡è¯†çš„Aè¯·æ±‚å·²ç»ä¸æ˜¯åœ¨pendingçŠ¶æ€å¹¶ä¸”åœ¨è¿™æ¬¡è¯·æ±‚çš„æ—¶é—´æˆ³çš„èŒƒå›´å†…ï¼ˆåœ¨åé¢è®²å“åº”æ‹¦æˆªå™¨çš„æ—¶å€™ä¼šæŠŠAçš„isPendingå­—æ®µåœ¨æŸç§æ¡ä»¶ä¸‹è®¾ç½®ä¸º<code>false</code>, å¹¶ä¸”å­˜å‚¨Aè¯·æ±‚å“åº”åçš„æ•°æ®ï¼‰ï¼ŒA1è¯·æ±‚å°±ç›´æ¥å»å–Aç¼“å­˜çš„æ•°æ®</p>
<p>è¿™é‡Œå°±æ¶‰åŠåˆ°ä¸Šé¢æ‰€è¯´çš„é€‚é…å™¨çš„ç”¨å¤„ï¼Œç›´æ¥åœ¨A1è¯·æ±‚configçš„é€‚é…å™¨è¿”å›ä¸€ä¸ªæˆåŠŸè½å®šçš„æœŸçº¦ï¼Œé€šè¿‡æ ‡è¯†æ‹¿åˆ°cacheå®ä¾‹ä¸­ç¼“å­˜çš„æ•°æ®æ•°æ®ã€‚</p>
<pre><code class="ts">// isPendingä¸ºfalseçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”åœ¨æ—¶é—´æˆ³çš„èŒƒå›´å†…
if (expire &amp;&amp; expire &gt; Date.now()) {
  tempConfig.adapter = () =&gt; {
    const resolveData: AxiosResponse = {
      data,
      headers: tempConfig.headers,
      config: {
        ...tempConfig,
        useCache: true,
      },
      // @ts-expect-error
      request: tempConfig,
    };
    return Promise.resolve(resolveData);
  };
}</code></pre>
<p>è¿™é‡Œå®šä¹‰ä¸€ä¸ª<code>useCache</code>çš„å­—æ®µè¡¨æ˜è¿™ä¸ªæ˜¯å†ç”¨ç¼“å­˜æ•°æ®ï¼Œåç»­çš„å“åº”æ‹¦æˆªå™¨ä¸­ä¼šè®²åˆ°</p>
</li>
</ol>
<ol start="3">
<li><p>å½“Aè¯·æ±‚å·²ç»åšè¿‡æ ‡è¯†çš„æ—¶å€™ï¼Œè¿™æ—¶å€™åˆè¿›æ¥ä¸€ä¸ªA1è¯·æ±‚</p>
<p>å€˜è‹¥ç¬¬ä¸€æ¬¡åšè¿‡æ ‡è¯†çš„Aè¯·æ±‚è¿˜åœ¨pendingçš„çŠ¶æ€ï¼Œæˆ‘åˆæƒ³å…±ç”¨ç¼“å­˜æ•°æ®ï¼Œä½†æ˜¯å¹¶ä¸æ¸…æ¥šä»€ä¹ˆæ—¶å€™Aè¯·æ±‚æ‰ä¼šç»“æŸã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬å°±æƒ³ï¼Œç”¨ä¸€ä¸ªå‘å¸ƒè®¢é˜…çš„æ¨¡å¼ï¼Œå°†A1è¯·æ±‚çš„<strong>æœŸçº¦è½å®šæ—¶æœº</strong>è®¢é˜…èµ·æ¥ï¼Œåœ¨Aè¯·æ±‚è½å®šçš„æ—¶å€™å‘Šè¯‰A1ä½ æ˜¯æ—¶å€™ä¹Ÿè¯¥è½å®šäº†å°±å»<strong>å‘å¸ƒ</strong>ä¿¡æ¯ï¼Œè¿™æ—¶å€™ç¼“å­˜çš„æ•°æ®å°±æ˜¯åœ¨Aè¯·æ±‚è½å®šæ—¶å€™ï¼Œå»å‘å¸ƒé¡ºä¾¿ç»™A1ä¼ é€’çš„.</p>
<blockquote>
<p>å…¶å®è¿™ä¸ªè¿‡ç¨‹å¯ä»¥æœ‰å¤šä¸ªA1è¿›æ¥</p>
</blockquote>
<p>å¦‚æœä¸å¥½ç†è§£çš„è¿™é‡Œæœ‰æµç¨‹å›¾</p>
<p>â€‹    <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210626111840112.png" alt="image-20210626111840112" title>
                </div>
                <div class="image-caption">image-20210626111840112</div>
            </figure></p>
<p><img src="image-20210626111852379.png" alt="image-20210626111852379"></p>
<pre><code class="ts"> // è¯´æ˜æ‰¾åˆ°äº†è¯·æ±‚ä½†æ˜¯æ‰¾åˆ°çš„è¿™ä¸ªç¼“å­˜çš„è¯·æ±‚è¿˜åœ¨pendingï¼Œè¿™æ—¶å€™è®¢é˜…ä¸€ä¸ªæœŸçº¦å¾…ä¼šè¦ç”¨
 tempConfig.adapter = () =&gt; new Promise((resolve) =&gt; {
     axiosEvent.once(cancelCacheKey, (res:unknown) =&gt; {
       const resolveData: AxiosResponse = {
         data: res,
         headers: tempConfig.headers,
         config: {
           ...tempConfig,
           useCache: true,
         },
         // @ts-expect-error
         request: tempConfig,
       };
       resolve(resolveData);
     });
 });</code></pre>
<p>è¿™é‡ŒA1è¯·æ±‚è®¢é˜…äº†ä»¥ä¸€ä¸ªä»¥cancelCacheKeyä¸ºæ ‡è¯†çš„ä¿¡å·ã€‚</p>
</li>
</ol>
<p>è‡³äºAè¯·æ±‚è½å®šçš„æ—¶æœºï¼Œåˆ°å“åº”æ‹¦æˆªå™¨ä¸­åšå¤„ç†</p>
<ol start="4">
<li>å¦‚æœAè¯·æ±‚è¯·æ±‚å¤±è´¥æ€ä¹ˆåŠï¼Ÿé‚£è¿™æ—¶å€™æˆ‘ä»¬ä¸åšå¤„ç†ï¼Œä¹Ÿä¸åšæ ‡è¯†ï¼Œè¯·æ±‚å¤±è´¥èµ°çš„æ˜¯è¯·æ±‚å¤±è´¥çš„æ‹¦æˆªå™¨ã€‚</li>
</ol>
<p>ä»¥ä¸‹æ˜¯æ•´ä¸ªè¯·æ±‚æ‹¦æˆªå™¨ä»£ç </p>
<pre><code class="ts">import { AxiosRequestConfig, AxiosResponse } from &#39;axios&#39;;
import { get } from &#39;lodash&#39;;
import getMark, { transformDataToString } from &#39;../utils/getMark&#39;;
import { axiosCache, axiosEvent } from &#39;../instances&#39;;

export function handleCancelCacheRequest(config:AxiosRequestConfig) {
  const tempConfig = config;
  // æ˜¯å¦å¼€å¯äº†ç¼“å­˜ï¼ˆå¤ç”¨é‡å¤è¯·æ±‚çŠ¶æ€ï¼‰
  const enabledCancelCache = get(tempConfig, &#39;enabledCancelCache&#39;);
  if (enabledCancelCache) {
    // è·å–æ ‡è¯†
    const cancelCacheKey = getMark(tempConfig);

    if (!axiosCache.has(cancelCacheKey)) {
      axiosCache.set(cancelCacheKey, {});
    }

    const {
      data, // ç¼“å­˜çš„æ•°æ®
      isPending, // è¯·æ±‚æ˜¯å¦æ˜¯pendingçŠ¶æ€
      expire, // æ—¶é—´æˆ³
    } = axiosCache.get(cancelCacheKey);

    if (isPending) {
      // è¯´æ˜æ‰¾åˆ°äº†è¯·æ±‚ä½†æ˜¯æ‰¾åˆ°çš„è¿™ä¸ªç¼“å­˜çš„è¯·æ±‚è¿˜åœ¨pendingï¼Œè¿™æ—¶å€™è®¢é˜…ä¸€ä¸ªæœŸçº¦å¾…ä¼šè¦ç”¨
      tempConfig.adapter = () =&gt; new Promise((resolve) =&gt; {
        axiosEvent.once(cancelCacheKey, (res:unknown) =&gt; {
          const resolveData: AxiosResponse = {
            data: res,
            headers: tempConfig.headers,
            config: {
              ...tempConfig,
              useCache: true,
            },
            // @ts-expect-error
            request: tempConfig,
          };
          resolve(resolveData);
        });
      });
    } else if (expire &amp;&amp; expire &gt; Date.now()) {
      tempConfig.adapter = () =&gt; {
        const resolveData: AxiosResponse = {
          data: transformDataToString(data),
          headers: tempConfig.headers,
          config: {
            ...tempConfig,
            useCache: true,
          },
          // @ts-expect-error
          request: tempConfig,
        };
        return Promise.resolve(resolveData);
      };
    } else {
      axiosCache.set(cancelCacheKey, {
        isPending: true,
      });
    }
  }

  return tempConfig;
}</code></pre>
<h4 id="å“åº”æ‹¦æˆªå™¨çš„å®ç°"><a href="#å“åº”æ‹¦æˆªå™¨çš„å®ç°" class="headerlink" title="å“åº”æ‹¦æˆªå™¨çš„å®ç°"></a>å“åº”æ‹¦æˆªå™¨çš„å®ç°</h4><p>å®ç°äº†è¯·æ±‚æ‹¦æˆªå™¨ä¹‹åï¼Œæˆ‘ä»¬æ¥å¤„ç†åœ¨å…ˆå‰æ‹¦æˆªå™¨ä¸­çš„ä¸€äº›å­—æ®µï¼Œä»¥åŠè¯·æ±‚å¤±è´¥çš„æ•°æ®å¤„ç†</p>
<ol>
<li><p>æˆ‘ä»¬å…ˆå¯¹å“åº”æˆåŠŸçš„çš„æ‹¦æˆªå™¨åšå¤„ç†</p>
<p>é¦–å…ˆæ˜¯å“åº”æˆåŠŸçš„æƒ…å†µä¸‹è€Œä¸”ä¹ŸæˆåŠŸæ‹¿åˆ°æƒ³è¦çš„æ•°æ®ï¼Œå‡è®¾è¿™ä¸ªå“åº”æˆåŠŸçš„è¯·æ±‚æ˜¯ä¸Šè¿°çš„Aè¯·æ±‚ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±åº”è¯¥è®°å½•ä¸‹Aè¯·æ±‚æœ€ç»ˆçš„æ‰€æœ‰æ•°æ®ä»¥åŠå®ƒéœ€è¦çš„ç¼“å­˜æ—¶é—´ï¼Œå¹¶ä¸”è®¾ç½®å®ƒisPendingå­—æ®µä¸ºfalseï¼Œæœ€é‡è¦çš„æ˜¯ç»™è®¢é˜…äº†cancelCacheKeyçš„ä¿¡æ¯çš„è¯·æ±‚ä»¬å‘å¸ƒä¸€ä¸ªä¿¡å·ï¼Œå‘Šè¯‰ä½ ä»¬å¯ä»¥æ¥æ‹¿æˆ‘çš„ï¼ˆAè¯·æ±‚ï¼‰æ•°æ®äº†ï¼</p>
<pre><code class="ts">if (enabledCancelCache &amp;&amp; !useCache) {
    const finalData = resData;
    axiosCache.set(config?.cancelCacheKey || cancelCacheKey, {
      data: finalData,
      isPending: false,
      expire: Date.now() + Number(enabledCancelCache) * 500,
    });
    // å‘å¸ƒè¿™ä¸ªä¿¡å·è®©æ‰€æœ‰è®¢é˜…äº†Açš„éƒ½èƒ½æ¥å—åˆ°ä¿¡æ¯
    axiosEvent.emit(cancelCacheKey, finalData);
}</code></pre>
<p>è¿™é‡Œä¸ºä»€ä¹ˆè¦å¤šä¸€æ¬¡useCacheçš„åˆ¤æ–­å‘¢?</p>
<p>å› ä¸ºæˆ‘å…ˆå‰åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­å¤„ç†äº†adapterç”¨æ¥å¤„ç†ç¼“å­˜, èµ°å®Œäº†adapteræ‰ä¼šèµ°å“åº”æ‹¦æˆªå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åœ¨å“åº”æ‹¦æˆªå™¨é‡Œå¤´è¿˜å¾—åˆ¤æ–­ï¼Œè¿™æ¬¡åˆ°åº•æ˜¯èµ°çš„ç¼“å­˜ï¼Œè¿˜æ˜¯ç¬¬ä¸€æ¬¡éœ€è¦åšç¼“å­˜å‘¢ï¼Ÿæ‰€ä»¥æ‰çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘åœ¨ä¸Šé¢çš„adapteré‡Œå¤´åŠ å…¥äº†useCacheçš„å­—æ®µã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯Aè¯·æ±‚ç¬¬ä¸€æ¬¡è¿›æ¥ï¼ŒuseCacheå°±æ˜¯falseï¼Œå°±å¾—å»å­˜å€¼ï¼Œæ¥ä¸‹æ¥è¿›æ¥A1ï¼Œé‚£æˆ‘å°±å¾—èµ°ç¼“å­˜ï¼Œæˆ‘ä¸å†å»é‡æ–°è®¾ç½®æ–°å€¼äº†ã€‚</p>
</li>
</ol>
<ol start="2">
<li><p>æ²¡æœ‰æˆåŠŸæ‹¿åˆ°æƒ³è¦çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åç«¯è¿”å›é”™è¯¯ä¿¡æ¯çš„æƒ…å†µ</p>
<p>è¿™é‡Œæˆ‘ä»¬çš„åå°è¿”å›çš„é”™è¯¯æ ‡è¯†æ˜¯failedå­—æ®µï¼Œå°±ç›´æ¥å°†isPendingè®¾ç½®ä¸ºfalseä¸åšåç»­å¤„ç†ï¼Œå¹¶ä¸”å°†åœ¨è®¢é˜…äº†çš„è¯·æ±‚ä¿¡å·éƒ½åˆ é™¤(åˆ é™¤æ˜¯å› ä¸ºAè¯·æ±‚å¤±è´¥å°±å·²ç»æŠ¥é”™ï¼Œå…¶ä»–è¯·æ±‚å°±ä¸å¿…å†é‡å¤æŠ¥é”™)</p>
<pre><code class="js">axiosCache.set(cancelCacheKey, {
  isPending: false,
});
axiosEvent.delete(cancelCacheKey);</code></pre>
</li>
<li><p>å½“ç„¶å“åº”å¤±è´¥æ‹¦æˆªå™¨ä¸­ä¹Ÿéœ€è¦åšä¸Šè¿°è¿™æ ·çš„å¤„ç†</p>
</li>
</ol>
<p>è¿™æ˜¯æœ€ç»ˆçš„å“åº”æˆåŠŸçš„æ‹¦æˆªå™¨ä»£ç ğŸ‘‡</p>
<pre><code class="js">import { AxiosResponse } from &#39;axios&#39;;
import get from &#39;lodash/get&#39;;
import {
  prompt,
} from &#39;@/utils&#39;;
import { axiosCache, axiosEvent } from &#39;../instances&#39;;
import getMark from &#39;../utils/getMark&#39;;

export default function handleResponseInterceptor(response:AxiosResponse) {
  const resData = get(response, &#39;data&#39;);
  const config = get(response, &#39;config&#39;) || {};

  const { enabledCancelCache, useCache } = config;
  const cancelCacheKey = getMark(config);
  if (get(response, &#39;status&#39;) === 204) {
    return response;
  }
  if (resData?.failed === true) {
    axiosCache.set(cancelCacheKey, {
      ...(axiosCache.get(cancelCacheKey) || {}),
      isPending: false,
    });

    if (!response?.config?.noPrompt) {
      prompt(resData.message, &#39;error&#39;);
    }
    throw resData;
  }

  if (enabledCancelCache &amp;&amp; !useCache) {
    const finalData = resData;
    axiosCache.set(config?.cancelCacheKey || cancelCacheKey, {
      data: finalData,
      isPending: false,
      expire: Date.now() + Number(enabledCancelCache) * 500,
    });
    axiosEvent.emit(cancelCacheKey, finalData);
  }

  return resData;
}
</code></pre>
<h3 id="åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚-1"><a href="#åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚-1" class="headerlink" title="åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚"></a>åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚</h3><p>è¿™é‡Œçš„æ€è·¯å°±ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼ŒæŒ‰ç…§ä¸Šé¢éœ€æ±‚åˆ†ææ‰€è¯´çš„å­˜å‚¨cancelTokenç»™æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œä¹‹ååˆ‡æ¢è·¯ç”±å°†pendingçš„è¯·æ±‚å–æ¶ˆæ‰</p>
<p>å› æ­¤æˆ‘ä»¬ä¸å•å•éœ€è¦å®ç°å­˜å‚¨cancelTokençš„ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿˜æœ‰å¤„ç†ä»–çš„æ‹¦æˆªå™¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç›‘å¬è·¯ç”±çš„å˜åŒ–ï¼Œæ‰¾åˆ°è¿™ä¸ªæ—¶æœºå°†æ‰€æœ‰pendingè¯·æ±‚cancelæ‰</p>
<h4 id="æ‹¦æˆªå™¨çš„å®ç°"><a href="#æ‹¦æˆªå™¨çš„å®ç°" class="headerlink" title="æ‹¦æˆªå™¨çš„å®ç°"></a>æ‹¦æˆªå™¨çš„å®ç°</h4><p>è¿™é‡Œæˆ‘ä»¬å°è£…ä¸€ä¸ªæ‹¦æˆªå™¨<code>routeCancelInterceptor</code></p>
<pre><code class="js">// æ·»åŠ åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(routeCancelInterceptor); // 4</code></pre>
<p>éœ€è¦ä¸€ä¸ªå–æ¶ˆè¯·æ±‚çš„é˜Ÿï¼Œåˆ—äºæ˜¯å°è£…ä¸€ä¸ªå®ä¾‹ç”¨æ¥å­˜å‚¨å¯¹åº”çš„è¯·æ±‚ï¼ŒåŒ…å«ç›¸å¯¹åº”çš„getï¼Œsetï¼Œç­‰æ–¹æ³•ï¼Œæœ€é‡è¦çš„æ˜¯</p>
<p>cancelAllRequestæ–¹æ³•ï¼Œç”¨äºéå†æ‰€æœ‰å­˜å‚¨çš„pendingè¯·æ±‚ï¼Œä¹‹ååœ¨åˆ‡è·¯ç”±çš„æ—¶å€™ï¼Œéå†æ•°æ®å–æ¶ˆå®ƒã€‚è¿™é‡Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å¼•å…¥å‰é¢åšäº†ç¼“å­˜çš„axiosCacheï¼Œåå¤´ä¼šç»†è®²</p>
<pre><code class="js">import { axiosCache } from &#39;./index&#39;;

class RouteAxios {
  constructor() {
    this.pendingRequest = new Map();
  }

  get size() {
    return this.pendingRequest.size;
  }

  get(key) {
    return this.pendingRequest.get(key);
  }

  delete(key) {
    this.pendingRequest.delete(key);
  }

  has(key) {
    return this.pendingRequest.has(key);
  }

  set(key, value) {
    this.pendingRequest.set(key, value);
  }

  isEmpty() {
    return !!this.pendingRequest.size;
  }

  clear() {
    this.pendingRequest = new Map();
  }

 cancelAllRequest() {
    for (const [key, value] of this.pendingRequest) {
      if (value?.cancel &amp;&amp; typeof value.cancel === &#39;function&#39;) {
        value.cancel();
        axiosCache.delete(key); // è¿™é‡Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿåç»­åœ¨è¯´
      }
    }
    this.clear();
  }
}
export const axiosRoutesCancel = new RouteAxios();

</code></pre>
<p>ä¹‹åè¦æˆ‘ä»¬å°±åœ¨è¯·æ±‚æ‹¦æˆªå™¨é‡Œå¤´å¤„ç†cancelToken</p>
<p>å½“ç„¶é¦–å…ˆä¹Ÿæ˜¯å…ˆæ£€æµ‹æ˜¯å¦æœ‰è¿™ä¸ª<code>enabledCancelRoute</code>å­—æ®µè¡¨æ˜æ˜¯å¦è¦å°†è¿™ä¸ªè¯·æ±‚åŠ å…¥åˆ‡æ¢è·¯ç”±å–æ¶ˆè¯·æ±‚çš„æ–¹æ¡ˆï¼Œä¹‹åè°ƒç”¨source()ï¼Œè·å–å­˜å‚¨å…¶<code>source.cancel</code>æ–¹æ³•ï¼Œé‡ç‚¹æ˜¯è¦åœ¨configä¸ŠåŠ å…¥cancelTokenï¼Œè¡¨æ˜è¿™ä¸ªè¯·æ±‚å¾…ä¼šå¯èƒ½ä¼šè¢«å–æ¶ˆï¼ˆç®€å•æ¥è®²è¿™ä¸ªæ ‡è¯†å¯¹åº”è¿™ä¸ªsource.cancelçš„æ‰§è¡Œç›®æ ‡ï¼‰</p>
<pre><code class="js">import axios, { AxiosRequestConfig } from &#39;axios&#39;;
import get from &#39;lodash/get&#39;;
import { axiosRoutesCancel } from &#39;../instances&#39;;
import getMark from &#39;../utils/getMark&#39;;

export function routeCancelInterceptor(config:AxiosRequestConfig) {
  const tempConfig = config;
  const enabledCancelRoute = get(tempConfig, &#39;enabledCancelRoute&#39;);
  if (enabledCancelRoute) {
    const cancelRouteKey = tempConfig?.cancelCacheKey || getMark(config);
    const { CancelToken } = axios;
    const source = CancelToken.source();
    tempConfig.cancelToken = source.token;
    axiosRoutesCancel.set(cancelRouteKey, {
      cancel: source.cancel,
      name: cancelRouteKey,
    });
  }

  return tempConfig;
}
</code></pre>
<p>å¦‚æœè¯·æ±‚åœ¨è¿˜æ²¡åˆ‡æ¢è·¯ç”±çš„æ—¶å€™å°±å·²ç»å“åº”æˆåŠŸï¼ˆè¿™é‡Œä¸ç®¡æ˜¯å¦æ‹¿åˆ°æ­£ç¡®æ•°æ®ï¼‰ï¼Œå°±åº”è¯¥ç›´æ¥åˆ é™¤è¿™ä¸ªå­˜å‚¨çš„keyå€¼</p>
<p>è¿™é‡Œå°±åœ¨å“åº”æˆåŠŸçš„æ‹¦æˆªå™¨ä¸­å¤„ç†ï¼Œåœ¨å¤±è´¥æ‹¦æˆªå™¨ä¸­ä¹Ÿæ˜¯ä¸€æ ·çš„å¤„ç†æ–¹æ¡ˆ</p>
<pre><code class="js">if (enabledCancelRoute) {
    axiosRoutesCancel.delete(cancelCacheKey);
}</code></pre>
<h4 id="è·¯ç”±å®ˆå«çš„å®ç°"><a href="#è·¯ç”±å®ˆå«çš„å®ç°" class="headerlink" title="è·¯ç”±å®ˆå«çš„å®ç°"></a>è·¯ç”±å®ˆå«çš„å®ç°</h4><p>å®ç°äº†æ‹¦æˆªå™¨æˆ‘ä»¬è¿˜éœ€è¦ç®€å•çš„å®ç°ä¸€ä¸ªè·¯ç”±å®ˆå«ï¼Œç”¨æ¥ç›‘å¬è·¯ç”±å˜åŒ–</p>
<p>åœ¨å…¨å±€ï¼Œæˆ‘ä»¬å°è£…äº†ä¸€ä¸ªå«åšPermissionRouteçš„å®ˆå«ï¼Œè¿™å®ˆå«æ˜¯å¯¹<code>react-router-dom</code>çš„routeåšäº†å˜å‘å°è£…</p>
<pre><code class="ts">const PermissionRoute: React.FC&lt;PermissionRouteProps&gt; =()=&gt; React.ReactDOM</code></pre>
<p>ç»™è¿™ä¸ªç»„ä»¶é…ç½®å‚æ•°ï¼Œå«åš<code>enabledRouteChangedAjaxBlock</code>ï¼Œé»˜è®¤ä¸ºtrue, æ ‡è¯†è¿™ä¸ªè·¯ç”±ä¸‹çš„è¯·æ±‚ï¼Œåœ¨åˆ‡æ¢çš„æ—¶å€™éƒ½ä¼šè¢«å–æ¶ˆï¼Œå½“ç„¶æ¯ä¸ªè¯·æ±‚è‡ªå·±ä¹Ÿä¼šæ ‡è¯†è‡ªå·±æ˜¯å¦åœ¨åˆ‡æ¢è·¯ç”±çš„æ—¶å€™è¦è¢«å–æ¶ˆï¼Œåè€…çš„ä¼˜å…ˆçº§å¤§äºå‰è€…</p>
<p>ä¹‹åæˆ‘ä»¬å†™ä¸€ä¸ªç»„ä»¶é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆè·¯ç”±åˆ‡æ¢çš„æ—¶å€™ï¼Œè¿™ä¸ªè·¯ç”±å¯¹åº”çš„è·¯ç”±å®ˆå«ç»„ä»¶å°±ä¼šè¢«é”€æ¯ï¼Œéšä¹‹é”€æ¯ï¼ˆå–æ¶ˆï¼‰çš„ä¹Ÿå°±æ˜¯å½“å‰é¡µé¢æ­£åœ¨pendingçš„è¯·æ±‚ï¼‰</p>
<pre><code class="js">useEffect(() =&gt; function () {
    if (enabledRouteChangedAjaxBlock &amp;&amp; axiosRoutesCancel.size) {
      axiosRoutesCancel.cancelAllRequest();
    }
},
[location]);</code></pre>
<p>useEffectè¿”å›ä¸€ä¸ªé”€æ¯çš„å‡½æ•°ï¼Œå¹¶ä¸”cancelæ‰æ‰€æœ‰pendingè¯·æ±‚ã€‚</p>
<p>è¿™é‡Œå…·ä½“å¯ä»¥çœ‹çœ‹PermissionRouteçš„å°è£…ä»£ç ï¼Œæ–¹ä¾¿ç†è§£</p>
<pre><code class="ts">import React, { useEffect, useMemo } from &#39;react&#39;;
import { Route, RouteProps, useLocation } from &#39;react-router-dom&#39;;
import { noaccess as NoAccess, Permission } from &#39;@/index&#39;;
import useQueryString from &#39;@/hooks/useQueryString&#39;;
import Skeleton from &#39;@/containers/components/c7n/master/skeleton&#39;;
import { axiosRoutesCancel } from &#39;@/containers/components/c7n/tools/axios/instances&#39;;

interface PermissionRouteProps extends RouteProps {
  service: string[] | ((type: &#39;project&#39; | &#39;organization&#39; | &#39;site&#39;) =&gt; string[]),
  enabledRouteChangedAjaxBlock: boolean,
}
const isFunction = (something: unknown): something is Function =&gt; typeof something === &#39;function&#39;;

const PermissionRoute: React.FC&lt;PermissionRouteProps&gt; = ({ enabledRouteChangedAjaxBlock = true, service, ...rest }) =&gt; {
  const { type } = useQueryString();
  const location = useLocation();
  const codes = useMemo(() =&gt; (isFunction(service) ? service(type) : (service || [])), [service, type]);
  const route = (
    &lt;Route
      {...rest}
    /&gt;
  );

  useEffect(() =&gt; function () {
    if (enabledRouteChangedAjaxBlock &amp;&amp; axiosRoutesCancel.size) {
      axiosRoutesCancel.cancelAllRequest();
    }
  },
  [location]);

  return (codes.length &gt; 0)
    ? (
      &lt;Permission
        service={codes}
        noAccessChildren={&lt;NoAccess /&gt;}
        defaultChildren={&lt;Skeleton /&gt;}
      &gt;
        {route}
      &lt;/Permission&gt;
    )
    : (
      &lt;Route
        {...rest}
      /&gt;
    );
};
export default PermissionRoute;


// ç”¨æ³•
&lt;PermissionRoute
    service={[&#39;choerodon.code.project.project.overview.ps.default&#39;]}
    exact
    path={`${match.url}agile/project-overview`}
    component={ProjectOverview}
/&gt;</code></pre>
<h2 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h2><h3 id="ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¸ç”¨CancelTokenå»å–æ¶ˆé‡å¤è¯·æ±‚è€Œç”¨ç¼“å­˜åŸç†ï¼Ÿ</h3><p>æˆ‘ä»¬çŸ¥é“å–æ¶ˆé‡å¤è¯·æ±‚åŸç†æ˜¯abortï¼Œå®šä¹‰æ˜¯ï¼šè¯·æ±‚å¦‚æœå‘å‡ºï¼Œåˆ™ç«‹åˆ»ç»ˆæ­¢è¯·æ±‚ï¼›</p>
<h4 id="åŸå› ä¸€ï¼š"><a href="#åŸå› ä¸€ï¼š" class="headerlink" title="åŸå› ä¸€ï¼š"></a>åŸå› ä¸€ï¼š</h4><p>è¿™ä¸ªç»ˆæ­¢å°±å¾ˆå¾®å¦™ï¼Œç»ˆæ­¢ä¹‹åçš„è¯·æ±‚æˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒèµ°äº†å“åº”å¤±è´¥çš„æ‹¦æˆªå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å‰ç«¯è¿˜æ˜¯æŠŠæ•°æ®å‘ç»™äº†åç«¯ï¼Œåç«¯è¿˜ä¼šåšæ•°æ®å¤„ç†æ¯”å¦‚ï¼ˆpostï¼Œputç­‰ï¼‰ï¼Œåªæ˜¯ç»ˆæ­¢äº†ï¼Œä½†æ˜¯åç«¯å¹¶ä¸çŸ¥é“æˆ‘ä»¬ç»ˆæ­¢äº†è¯·æ±‚ï¼Œåªæ˜¯å‰ç«¯ç»ˆæ­¢æ²¡æœ‰åœ¨åƒå“åº”æˆåŠŸæ‹¦æˆªå™¨ä¸€æ ·å¯¹æ•°æ®åšå¤„ç†</p>
<p>ä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬è¦çš„æ•ˆæœä¸æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬è¦çš„æ˜¯åœ¨é‚£ä¸€ç¬é—´çš„æ‰€æœ‰ç›¸åŒè¯·æ±‚çŠ¶æ€å¤ç”¨ï¼Œé‡å¤çš„è¯·æ±‚ä»¬æ˜¯ä¸å¯ä»¥åœ¨é‚£ä¸€ç¬é—´å†å‘é€ç»™åç«¯çš„ï¼Œè€Œæ˜¯åªæœ‰é‚£ä¸ªç¬¬ä¸€æ¬¡çš„è¯·æ±‚æ‰å‘å‡ºå»ï¼Œå¦‚æœä½¿ç”¨CancelTokenè¿™æ ·å°±æ²¡æœ‰æ„ä¹‰äº†</p>
<h4 id="åŸå› äºŒ"><a href="#åŸå› äºŒ" class="headerlink" title="åŸå› äºŒ"></a>åŸå› äºŒ</h4><p>abortä¼šå¯¼è‡´æµè§ˆå™¨ä¸­çš„networkä¸­ä¸€å †æŠ¥çº¢ï¼Œçœ‹ä¸Šå»æ¯”è¾ƒä¸ç¾è§‚ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="image-20210627124622241.png" alt="image-20210627124622241" title>
                </div>
                <div class="image-caption">image-20210627124622241</div>
            </figure>



<h4 id="åŸå› ä¸‰"><a href="#åŸå› ä¸‰" class="headerlink" title="åŸå› ä¸‰"></a>åŸå› ä¸‰</h4><p>å¦‚æœç”¨äº†cancelTokenæˆ‘åˆæƒ³åšç¼“å­˜ï¼Œè¿˜ä¸å¦‚ç›´æ¥ç”¨ç¼“å­˜æ¥ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°æ•ˆæœ</p>
<h3 id="ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ‹¦æˆªå™¨çš„æ·»åŠ é¡ºåºä¼šå½±å“åˆ°ç¼“å­˜ï¼Ÿ</h3><p>è¿™ä¹Ÿæ˜¯åœ¨ä¸Šé¢è®²axiosçš„adapterçš„æ—¶å€™æåŠè¿‡</p>
<p>è¯·æ±‚æ‹¦æˆªå™¨æ˜¯çš„æ‰§è¡Œé¡ºåºæ˜¯åæ·»åŠ çš„å…ˆæ‰§è¡Œ</p>
<p>å“åº”æ‹¦æˆªå™¨æ˜¯å…ˆæ·»åŠ çš„å…ˆæ‰§è¡Œ</p>
<p>ä¾‹å¦‚ï¼šæˆ‘ä»¬é¡¹ç›®çš„è¯·æ±‚æ‹¦æˆªå™¨æ˜¯è¿™æ ·æ·»åŠ çš„</p>
<pre><code class="js">// æ·»åŠ åˆ‡æ¢è·¯ç”±å–æ¶ˆpendingè¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(routeCancelInterceptor); // 4

// æ·»åŠ ç¼“å­˜(å¤ç”¨é‡å¤è¯·æ±‚)è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(handleCancelCacheRequest, handleRequestError); // 3

// åˆ†é¡µæ•°æ®è½¬æ¢æ‹¦æˆªå™¨
instance.interceptors.request.use(transformRequestPage); // 2

// æ·»åŠ å¤´éƒ¨æ‹¦æˆªå™¨ï¼Œ ä»¥åŠè¯·æ±‚å¤±è´¥æ‹¦æˆªå™¨
instance.interceptors.request.use(addCustomHeader); // 1</code></pre>
<p>æŒ‰é¡ºåºæ˜¯ä»ä¸‹åˆ°ä¸Šæ‰§è¡Œï¼ŒæŒ‰ç…§æ ‡æ³¨çš„1ï¼Œ2ï¼Œ3ï¼Œ4æ‰§è¡Œ</p>
<p>å“åº”æ‹¦æˆªå™¨æ˜¯è¿™æ ·çš„</p>
<pre><code class="js">// æ·»åŠ å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(transformResponsePage); // 1
instance.interceptors.response.use(handleResponseInterceptor, handelResponseError); // 2</code></pre>
<h3 id="è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ"><a href="#è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ" class="headerlink" title="è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ"></a>è·¯ç”±å–æ¶ˆcancelAllRequestæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦åˆ é™¤cacheä¸­çš„æ•°æ®ï¼Ÿ</h3><h2 id="éš¾ç‚¹è§£å†³"><a href="#éš¾ç‚¹è§£å†³" class="headerlink" title="éš¾ç‚¹è§£å†³"></a>éš¾ç‚¹è§£å†³</h2>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2022-02-09T01:45:19.167Z" itemprop="dateUpdated">2022-02-09 09:45:19</time>
</span><br>


        
        Happy Coding
        
    </div>
    
    <footer>
        <a href="https://github.com/NollieLeo">
            <img src="/img/avatar.png" alt="Mr.Weng">
            Mr.Weng
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/" rel="tag">js</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&title=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&pic=https://github.com/NollieLeo/img/avatar.png" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&title=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&via=https://github.com/NollieLeo" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/07/01/js%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">jså¸¸è§é¢è¯•é¢˜</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/06/20/%E7%AE%97%E6%B3%95%E4%B9%8B%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%89%80%E6%9C%89%E8%B7%AF%E5%BE%84/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">ç®—æ³•ä¹‹äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        è°¢è°¢å¤§çˆ·~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/false" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>åšå®¢å†…å®¹éµå¾ª <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Mr.Weng &copy; 2020 - 2023</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&title=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&pic=https://github.com/NollieLeo/img/avatar.png" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&title=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠåŸºäºçŒªé½¿é±¼å¹³å°çš„axiosç¼“å­˜å°è£…ã€‹ â€” ç¿è€å¸ˆçš„åšå®¢&url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/&via=https://github.com/NollieLeo" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://github.com/NollieLeo/2021/06/24/%E5%9F%BA%E4%BA%8E%E7%8C%AA%E9%BD%BF%E9%B1%BC%E5%B9%B3%E5%8F%B0%E7%9A%84axios%E7%BC%93%E5%AD%98%E5%B0%81%E8%A3%85/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'æˆ‘èµ°äº†';
            clearTimeout(titleTime);
        } else {
            document.title = 'æˆ‘æ¥äº†';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
